import{g as Le,r as p}from"./index-TjLUG_Bo.js";import{cs as me,ct as ge,cu as We,cv as F,cw as J,cx as P,cy as Oe,cz as $e,R as _e,a_ as Me,a5 as he,bb as ze,a as _,b9 as Ve,W as $,M as Q,x as Pe,b as ae,L as M,q as z,v as pe,bs as fe,cA as be,cB as xe,o as B,a6 as V,a4 as j,bN as De,K as X,l as Re,Q as Be,cC as He,k as Fe,au as U,G as ne,bd as Ue,be as Ge,cD as Ze,cE as qe,aq as Ke,br as Qe,cF as Ce,a9 as Xe,t as Je,ck as Ye,as as et,at as ie,O as we,ai as tt,cG as nt,bQ as st,b$ as rt}from"./index-B1yGdhtz.js";import{j as r}from"./jsx-runtime-DF5SV9au.js";import{D as G,_ as at}from"./index-BHYcTakE.js";var Y,oe;function it(){return oe||(oe=1,Y={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0}),Y}var ot=it();const lt=Le(ot);var ct=/\s([^'"/\s><]+?)[\s/>]|([^\s=]+)=\s?(".*?"|'.*?')/g;function le(e){var t={type:"tag",name:"",voidElement:!1,attrs:{},children:[]},s=e.match(/<\/?([^\s]+?)[/\s>]/);if(s&&(t.name=s[1],(lt[s[1]]||e.charAt(e.length-2)==="/")&&(t.voidElement=!0),t.name.startsWith("!--"))){var n=e.indexOf("-->");return{type:"comment",comment:n!==-1?e.slice(4,n):""}}for(var i=new RegExp(ct),a=null;(a=i.exec(e))!==null;)if(a[0].trim())if(a[1]){var c=a[1].trim(),l=[c,""];c.indexOf("=")>-1&&(l=c.split("=")),t.attrs[l[0]]=l[1],i.lastIndex--}else a[2]&&(t.attrs[a[2]]=a[3].trim().substring(1,a[3].length-1));return t}var ut=/<[a-zA-Z0-9\-\!\/](?:"[^"]*"|'[^']*'|[^'">])*>/g,dt=/^\s*$/,mt=Object.create(null);function ye(e,t){switch(t.type){case"text":return e+t.content;case"tag":return e+="<"+t.name+(t.attrs?function(s){var n=[];for(var i in s)n.push(i+'="'+s[i]+'"');return n.length?" "+n.join(" "):""}(t.attrs):"")+(t.voidElement?"/>":">"),t.voidElement?e:e+t.children.reduce(ye,"")+"</"+t.name+">";case"comment":return e+"<!--"+t.comment+"-->"}}var gt={parse:function(e,t){t||(t={}),t.components||(t.components=mt);var s,n=[],i=[],a=-1,c=!1;if(e.indexOf("<")!==0){var l=e.indexOf("<");n.push({type:"text",content:l===-1?e:e.substring(0,l)})}return e.replace(ut,function(f,d){if(c){if(f!=="</"+s.name+">")return;c=!1}var u,y=f.charAt(1)!=="/",m=f.startsWith("<!--"),v=d+f.length,b=e.charAt(v);if(m){var h=le(f);return a<0?(n.push(h),n):((u=i[a]).children.push(h),n)}if(y&&(a++,(s=le(f)).type==="tag"&&t.components[s.name]&&(s.type="component",c=!0),s.voidElement||c||!b||b==="<"||s.children.push({type:"text",content:e.slice(v,e.indexOf("<",v))}),a===0&&n.push(s),(u=i[a-1])&&u.children.push(s),i[a]=s),(!y||s.voidElement)&&(a>-1&&(s.voidElement||s.name===f.slice(2,-1))&&(a--,s=a===-1?n:i[a]),!c&&b!=="<"&&b)){u=a===-1?n:i[a].children;var w=e.indexOf("<",v),x=e.slice(v,w===-1?void 0:w);dt.test(x)&&(x=" "),(w>-1&&a+u.length>=0||x!==" ")&&u.push({type:"text",content:x})}}),n},stringify:function(e){return e.reduce(function(t,s){return t+ye("",s)},"")}};const ee=(e,t)=>{var n;if(!e)return!1;const s=((n=e.props)==null?void 0:n.children)??e.children;return t?s.length>0:!!s},te=e=>{var s,n;if(!e)return[];const t=((s=e.props)==null?void 0:s.children)??e.children;return(n=e.props)!=null&&n.i18nIsDynamicList?R(t):t},ht=e=>Array.isArray(e)&&e.every(p.isValidElement),R=e=>Array.isArray(e)?e:[e],pt=(e,t)=>{const s={...t};return s.props=Object.assign(e.props,t.props),s},ve=(e,t,s,n)=>{if(!e)return"";let i="";const a=R(e),c=t!=null&&t.transSupportBasicHtmlNodes?t.transKeepBasicHtmlNodesFor??[]:[];return a.forEach((l,f)=>{if(F(l)){i+=`${l}`;return}if(p.isValidElement(l)){const{props:d,type:u}=l,y=Object.keys(d).length,m=c.indexOf(u)>-1,v=d.children;if(!v&&m&&!y){i+=`<${u}/>`;return}if(!v&&(!m||y)||d.i18nIsDynamicList){i+=`<${f}></${f}>`;return}if(m&&y===1&&F(v)){i+=`<${u}>${v}</${u}>`;return}const b=ve(v,t,s,n);i+=`<${f}>${b}</${f}>`;return}if(l===null){J(s,"TRANS_NULL_VALUE","Passed in a null value as child",{i18nKey:n});return}if(P(l)){const{format:d,...u}=l,y=Object.keys(u);if(y.length===1){const m=d?`${y[0]}, ${d}`:y[0];i+=`{{${m}}}`;return}J(s,"TRANS_INVALID_OBJ","Invalid child - Object should only have keys {{ value, format }} (format is optional).",{i18nKey:n,child:l});return}J(s,"TRANS_INVALID_VAR","Passed in a variable like {number} - pass variables for interpolation as full objects like {{number}}.",{i18nKey:n,child:l})}),i},ft=(e,t,s,n,i,a,c)=>{if(s==="")return[];const l=i.transKeepBasicHtmlNodesFor||[],f=s&&new RegExp(l.map(x=>`<${x}`).join("|")).test(s);if(!e&&!t&&!f&&!c)return[s];const d=t??{},u=x=>{R(x).forEach(C=>{F(C)||(ee(C)?u(te(C)):P(C)&&!p.isValidElement(C)&&Object.assign(d,C))})};u(e);const y=gt.parse(`<0>${s}</0>`),m={...d,...a},v=(x,k,C)=>{var N;const T=te(x),S=h(T,k.children,C);return ht(T)&&S.length===0||(N=x.props)!=null&&N.i18nIsDynamicList?T:S},b=(x,k,C,T,S)=>{x.dummy?(x.children=k,C.push(p.cloneElement(x,{key:T},S?void 0:k))):C.push(...p.Children.map([x],N=>{const g={...N.props};return delete g.i18nIsDynamicList,p.createElement(N.type,{...g,key:T,ref:N.props.ref??N.ref},S?null:k)}))},h=(x,k,C)=>{const T=R(x);return R(k).reduce((N,g,W)=>{var E,O;const o=((O=(E=g.children)==null?void 0:E[0])==null?void 0:O.content)&&n.services.interpolator.interpolate(g.children[0].content,m,n.language);if(g.type==="tag"){let A=T[parseInt(g.name,10)];!A&&t&&(A=t[g.name]),C.length===1&&!A&&(A=C[0][g.name]),A||(A={});const I=Object.keys(g.attrs).length!==0?pt({props:g.attrs},A):A,D=p.isValidElement(I),Z=D&&ee(g,!0)&&!g.voidElement,q=f&&P(I)&&I.dummy&&!D,K=P(t)&&Object.hasOwnProperty.call(t,g.name);if(F(I)){const L=n.services.interpolator.interpolate(I,m,n.language);N.push(L)}else if(ee(I)||Z){const L=v(I,g,C);b(I,L,N,W)}else if(q){const L=h(T,g.children,C);b(I,L,N,W)}else if(Number.isNaN(parseFloat(g.name)))if(K){const L=v(I,g,C);b(I,L,N,W,g.voidElement)}else if(i.transSupportBasicHtmlNodes&&l.indexOf(g.name)>-1)if(g.voidElement)N.push(p.createElement(g.name,{key:`${g.name}-${W}`}));else{const L=h(T,g.children,C);N.push(p.createElement(g.name,{key:`${g.name}-${W}`},L))}else if(g.voidElement)N.push(`<${g.name} />`);else{const L=h(T,g.children,C);N.push(`<${g.name}>${L}</${g.name}>`)}else if(P(I)&&!D){const L=g.children[0]?o:null;L&&N.push(L)}else b(I,o,N,W,g.children.length!==1||!o)}else if(g.type==="text"){const A=i.transWrapTextNodes,I=c?i.unescape(n.services.interpolator.interpolate(g.content,m,n.language)):n.services.interpolator.interpolate(g.content,m,n.language);A?N.push(p.createElement(A,{key:`${g.name}-${W}`},I)):N.push(I)}return N},[])},w=h([{dummy:!0,children:e||[]}],y,R(e||[]));return te(w[0])},Ne=(e,t,s)=>{const n=e.key||t,i=p.cloneElement(e,{key:n});if(!i.props||!i.props.children||s.indexOf(`${t}/>`)<0&&s.indexOf(`${t} />`)<0)return i;function a(){return p.createElement(p.Fragment,null,i)}return p.createElement(a,{key:n})},bt=(e,t)=>e.map((s,n)=>Ne(s,n,t)),xt=(e,t)=>{const s={};return Object.keys(e).forEach(n=>{Object.assign(s,{[n]:Ne(e[n],n,t)})}),s},Ct=(e,t,s,n)=>e?Array.isArray(e)?bt(e,t):P(e)?xt(e,t):(me(s,"TRANS_INVALID_COMPONENTS",'<Trans /> "components" prop expects an object or array',{i18nKey:n}),null):null,wt=e=>!P(e)||Array.isArray(e)?!1:Object.keys(e).reduce((t,s)=>t&&Number.isNaN(Number.parseFloat(s)),!0);function yt({children:e,count:t,parent:s,i18nKey:n,context:i,tOptions:a={},values:c,defaults:l,components:f,ns:d,i18n:u,t:y,shouldUnescape:m,...v}){var D,Z,q,K,L,re;const b=u||ge();if(!b)return me(b,"NO_I18NEXT_INSTANCE","Trans: You need to pass in an i18next instance using i18nextReactModule",{i18nKey:n}),e;const h=y||b.t.bind(b)||(Se=>Se),w={...We(),...(D=b.options)==null?void 0:D.react};let x=d||h.ns||((Z=b.options)==null?void 0:Z.defaultNS);x=F(x)?[x]:x||["translation"];const k=ve(e,w,b,n),C=l||k||w.transEmptyNodeValue||n,{hashTransKey:T}=w,S=n||(T?T(k||C):k||C);(K=(q=b.options)==null?void 0:q.interpolation)!=null&&K.defaultVariables&&(c=c&&Object.keys(c).length>0?{...c,...b.options.interpolation.defaultVariables}:{...b.options.interpolation.defaultVariables});const N=c||t!==void 0&&!((re=(L=b.options)==null?void 0:L.interpolation)!=null&&re.alwaysFormat)||!e?a.interpolation:{interpolation:{...a.interpolation,prefix:"#$?",suffix:"?$#"}},g={...a,context:i||a.context,count:t,...c,...N,defaultValue:C,ns:x},W=S?h(S,g):C,o=Ct(f,W,b,n);let E=o||e,O=null;wt(o)&&(O=o,E=e);const A=ft(E,O,W,b,w,g,m),I=s??w.defaultTransParent;return I?p.createElement(I,v,A):A}function qt({children:e,count:t,parent:s,i18nKey:n,context:i,tOptions:a={},values:c,defaults:l,components:f,ns:d,i18n:u,t:y,shouldUnescape:m,...v}){var k;const{i18n:b,defaultNS:h}=p.useContext(Oe)||{},w=u||b||ge(),x=y||(w==null?void 0:w.t.bind(w));return yt({children:e,count:t,parent:s,i18nKey:n,context:i,tOptions:a,values:c,defaults:l,components:f,ns:d||(x==null?void 0:x.ns)||h||((k=w==null?void 0:w.options)==null?void 0:k.defaultNS),i18n:w,t:y,shouldUnescape:m,...v})}var vt="orderly_selected_chains",Nt=6,jt=e=>{let{networkId:t,bridgeLessOnly:s}=e||{},{setStorageChain:n}=$e(),i=_e(),[a,{checkChainSupport:c}]=Me(),{setChain:l,connectedChain:f}=he(),{onChainChanged:d,currentChainId:u,setCurrentChainId:y,wrongNetwork:m}=G(),[v,b]=p.useState(u),{getComponentTheme:h}=ze(),w=p.useMemo(()=>({mainnet:(s?a.mainnet.filter(o=>o.network_infos.bridgeless):a.mainnet).map(o=>({name:o.network_infos.name,id:o.network_infos.chain_id,lowestFee:o.network_infos.bridgeless,isTestnet:!1})),testnet:a.testnet.map(o=>({name:o.network_infos.name,id:o.network_infos.chain_id,lowestFee:o.network_infos.bridgeless,isTestnet:!0}))}),[a,s]),x=p.useMemo(()=>!(h("chainSelector",{showTestnet:!0}).showTestnet===!1||!w.testnet.length),[w.testnet]),{recentChains:k,saveRecentChain:C}=Tt(w),T=async o=>{if(f){let E=await l({chainId:o.id});return E&&{result:E,wrongNetwork:!c(o.id,i.get("networkId")),chainId:o.id}}return n(o.id),y(o.id),{result:!0,wrongNetwork:!1,chainId:o.id}},S=(o,E)=>{var A;let O={isTestnet:o.isTestnet,isWalletConnected:E};(A=e.onChainChangeAfter)==null||A.call(e,o.id,O),d==null||d(o.id,O)},N=async o=>{var E,O,A;b(o.id),(E=e.onChainChangeBefore)==null||E.call(e,o.id,{isTestnet:o.isTestnet});try{let I=await(T==null?void 0:T(o));I?((O=e.resolve)==null||O.call(e,I),(A=e.close)==null||A.call(e),C(o),S(o,!0)):(b(void 0),S(o,!1))}catch{S(o,!1)}},{selectedTab:g,onTabChange:W}=kt(w,u,m,x);return{recentChains:k,chains:w,selectChainId:v,onChainClick:N,selectedTab:g,onTabChange:W,showTestnet:x}};function kt(e,t,s,n){let[i,a]=p.useState("Mainnet"),c=l=>{a(l)};return p.useEffect(()=>{var l,f;if(!n){a("Mainnet");return}if(t){if((l=e.mainnet)!=null&&l.some(d=>d.id===t)){a(s?"Testnet":"Mainnet");return}if((f=e.testnet)!=null&&f.some(d=>d.id===t)){a(s?"Mainnet":"Testnet");return}}},[t,e,s,n]),{selectedTab:i,onTabChange:c}}function Tt(e){let[t,s]=pe(vt,[]),n=p.useMemo(()=>t==null?void 0:t.map(a=>{var c;return(c=e.mainnet)==null?void 0:c.find(l=>l.id===parseInt(a))}).filter(a=>!!a),[e,t]),i=p.useCallback(a=>{if(a.isTestnet)return;let c=t==null?void 0:t.filter(l=>l!==a.id);c=[a.id,...c].slice(0,Nt),s(c)},[t]);return{recentChains:n,saveRecentChain:i}}var Et=Ve({slots:{icon:"",list:"oui-grid oui-grid-cols-1 oui-gap-1",mainnetList:'"',testnetList:'"',recentList:"",item:"oui-w-full oui-rounded-md",tip:"oui-text-center"},variants:{variant:{compact:{icon:"oui-w-6 oui-h-6",list:"oui-bg-base-9 oui-rounded-lg oui-p-1",mainnetList:"oui-grid-cols-2 oui-mt-4",testnetList:"oui-grid-cols-1 oui-mt-4",recentList:"oui-mt-4",item:"oui-bg-base-6 hover:oui-bg-base-7",tip:"oui-pt-6"},wide:{icon:"oui-w-[18px] oui-h-[18px]",mainnetList:"oui-grid-cols-3 oui-mt-3",testnetList:"oui-grid-cols-2 oui-mt-3",recentList:"oui-mt-3",item:"oui-bg-base-5 hover:oui-bg-base-6",tip:"oui-pt-8"}},selected:{true:{item:""},false:{item:"oui-bg-transparent"}}},compoundVariants:[{variant:"compact",selected:!0,className:{item:"hover:oui-bg-base-6"}},{variant:"wide",selected:!0,className:{item:"hover:oui-bg-base-5"}}],defaultVariants:{variant:"wide",selected:!1}}),It=e=>{var y,m,v,b;let{isWrongNetwork:t,variant:s="wide"}=e,{t:n}=_(),{list:i,recentList:a,mainnetList:c,testnetList:l,icon:f,item:d,tip:u}=Et({variant:s});return r.jsxs($,{className:Q("oui-font-semibold",e.className),children:[r.jsxs(Pe,{value:e.selectedTab,variant:"contained",size:s==="wide"?"md":"lg",onValueChange:h=>e.onTabChange(h),children:[r.jsxs(ae,{value:"Mainnet",title:n("connector.mainnet"),children:[!!((y=e.recentChains)!=null&&y.length)&&r.jsx(M,{gap:2,className:a(),children:(m=e.recentChains)==null?void 0:m.map(h=>r.jsx(At,{item:h,onClick:()=>e.onChainClick(h),iconClassName:f()},h.id))}),r.jsx($,{r:"2xl",className:Q(i(),c()),children:(v=e.chains.mainnet)==null?void 0:v.map(h=>{let w=e.selectChainId===h.id;return r.jsx(ce,{selected:w,item:h,onClick:()=>e.onChainClick(h),className:d({selected:w})},h.id)})})]}),e.showTestnet&&r.jsx(ae,{value:"Testnet",title:n("connector.testnet"),children:r.jsx($,{r:"2xl",className:Q(i(),l()),children:(b=e.chains.testnet)==null?void 0:b.map(h=>{let w=e.selectChainId===h.id;return r.jsx(ce,{selected:w,item:h,onClick:()=>e.onChainClick(h),className:d({selected:w})},h.id)})})})]}),t&&r.jsx($,{className:u(),children:r.jsx(z,{color:"warning",size:"xs",children:n("connector.wrongNetwork.tooltip")})})]})},ce=e=>{let{item:t}=e;return r.jsx("button",{className:e.className,onClick:e.onClick,children:r.jsxs(M,{justify:"between",className:"oui-py-2.5",px:3,children:[r.jsxs(M,{itemAlign:"center",width:"100%",className:"oui-gap-x-[6px]",children:[r.jsx(fe,{chainId:t.id,size:"xs"}),r.jsx(z,{size:"2xs",children:t.name})]}),e.selected&&r.jsx($,{gradient:"brand",r:"full",width:4,height:4})]})})},At=e=>r.jsx("button",{className:"oui-border oui-border-line-12 oui-rounded-lg hover:oui-border-primary-light",onClick:e.onClick,children:r.jsx(M,{itemAlign:"center",p:2,children:r.jsx(fe,{chainId:e.item.id,className:e.iconClassName})})}),je=e=>{let t=jt(e);return r.jsx(It,{...t,variant:e.variant,isWrongNetwork:e.isWrongNetwork})},ke="ChainSelectorDialogId",Te="ChainSelectorSheetId";be(ke,je,{size:"lg",title:()=>B.t("connector.switchNetwork"),variant:"wide",isWrongNetwork:!0});xe(Te,je,{title:()=>B.t("connector.switchNetwork"),classNames:{content:"!oui-bg-base-8",body:"!oui-bg-base-8"},variant:"compact",isWrongNetwork:!0});var St=e=>{let{title:t,description:s}=e;return r.jsxs($,{position:"relative",className:"oui-pl-8",children:[r.jsxs($,{children:[r.jsx(z,{as:"div",intensity:98,size:"sm",children:t}),r.jsx(z,{as:"div",intensity:54,size:"2xs",children:s})]}),r.jsx("div",{className:"oui-absolute oui-left-0 oui-top-1 oui-z-10",children:r.jsx(Lt,{...e})})]})},Lt=e=>{let{active:t,isLoading:s,isCompleted:n}=e;return s?r.jsx(tt,{size:"sm",className:"oui-ml-1"}):n?r.jsx(nt,{opacity:1,className:"oui-text-primary"}):r.jsx(Wt,{active:!!t})},Wt=({active:e,className:t})=>r.jsx("div",{className:Q("oui-w-[8.3px] oui-h-[8.3px] oui-rounded-full oui-ml-2 oui-mt-1",t,e?"oui-bg-primary-light":"oui-bg-base-2")}),Ot=e=>{let{initAccountState:t=j.NotConnected}=e,[s,n]=p.useState(!0),i=Qe(),{t:a}=_(),{disconnect:c,namespace:l}=he(),{state:f,account:d}=V(),[u,y]=p.useState(t),[m,v]=p.useState(0),[b,h]=p.useState(!1),[w,x]=p.useState(!1),{ledgerWallet:k}=Ce(),C=p.useRef(0),[T]=pe("orderly-first-show-wallet-connector-dialog",void 0);p.useEffect(()=>()=>{localStorage.setItem("orderly-first-show-wallet-connector-dialog","1")},[]),p.useEffect(()=>{y(f.status)},[f]);let S=p.useMemo(()=>{let o=[];return t<j.SignedIn&&o.push({key:"signIn",title:a("connector.createAccount"),description:a("connector.createAccount.description")}),t<j.EnableTrading&&o.push({key:"enableTrading",title:a("connector.enableTrading"),description:a("connector.enableTrading.description")}),o},[t,a]);p.useEffect(()=>{if(l!=Xe.solana){x(!1);return}if(!k){x(!0);return}if(k&&d.address&&!k.includes(d.address)){x(!0);return}x(!1)},[l,d.address,k]);let N=()=>(h(!0),e.enableTrading(s).then(async o=>{var E;C.current++,h(!1),v(O=>O+1);try{await((E=e.enableTradingComplted)==null?void 0:E.call(e))}catch{}typeof e.onCompleted=="function"?e.onCompleted():typeof e.close=="function"&&e.close()},o=>{if(h(!1),o!==-1){if(o.message.indexOf("Signing off chain messages with Ledger is not yet supported")!==-1){i.emit("wallet:sign-message-with-ledger-error",{message:o.message,userAddress:d.address});return}U.error(de(o))}}).catch(o=>{h(!1)})),g=async()=>{var o;localStorage.removeItem("orderly_link_device"),c({label:(o=u.connectWallet)==null?void 0:o.name}).then(()=>{d.disconnect(),typeof e.close=="function"&&e.close()})},W=()=>(h(!0),e.signIn().then(o=>{v(E=>E+1),N()},o=>{if(h(!1),o!==-1){if(o.message.indexOf("Signing off chain messages with Ledger is not yet supported")!==-1){i.emit("wallet:sign-message-with-ledger-error",{message:o.message,userAddress:d.address});return}U.error(de(o))}}).catch(o=>{h(!1)}));return r.jsxs($,{id:"oui-wallet-connect-dialog-content",className:"oui-font-semibold",children:[r.jsx(z,{intensity:54,size:"xs",children:a("connector.expired")}),r.jsxs($,{p:4,my:6,intensity:600,r:"lg",className:"oui-space-y-5",position:"relative",children:[S.map((o,E)=>r.jsx(St,{title:o.title,description:o.description,isCompleted:m>E,active:m===E,isLoading:b&&m===E},o.key)),S.length>1&&r.jsx($,{position:"absolute",height:"38px",left:28,top:18,zIndex:0,children:r.jsx(Je,{lineStyle:"dashed",direction:"vertical",intensity:16,className:"oui-h-full"})})]}),e.showRefCodeInput&&S.length==2&&r.jsx(Mt,{...e}),T&&r.jsxs(M,{justify:"between",itemAlign:"center",children:[r.jsx(zt,{}),r.jsx(Ye,{color:"primary",checked:s,onCheckedChange:n,disabled:b,className:"data-[state=checked]:oui-bg-primary-darken"})]}),r.jsx(M,{justify:"center",mt:8,className:"oui-w-full",children:r.jsx($,{className:"oui-w-full",children:r.jsx(_t,{state:u,signIn:W,enableTrading:N,loading:b,disabled:u>=j.EnableTrading,showLedgerButton:w})})}),u>j.NotConnected&&r.jsxs(M,{justify:"center",mt:4,gap:1,className:"oui-w-full oui-cursor-pointer",onClick:g,children:[r.jsx($t,{}),r.jsx(z,{className:"oui-text-base-contrast-80 oui-text-sm",children:a("connector.disconnectWallet")})]})]})},$t=()=>r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 18 18",fill:"none",children:r.jsx("path",{d:"M2.24219 5.24316C2.24219 3.58641 3.58536 2.24316 5.24219 2.24316H8.24219C9.89894 2.24316 11.2422 3.58641 11.2422 5.24316C11.2422 5.65716 10.9062 5.99316 10.4922 5.99316C10.0782 5.99316 9.74219 5.65716 9.74219 5.24316C9.74219 4.41441 9.07094 3.74316 8.24219 3.74316H5.24219C4.41374 3.74316 3.74219 4.41441 3.74219 5.24316V12.7432C3.74219 13.5719 4.41374 14.2432 5.24219 14.2432H8.24219C9.07094 14.2432 9.74219 13.5719 9.74219 12.7432C9.74219 12.3292 10.0782 11.9932 10.4922 11.9932C10.9062 11.9932 11.2422 12.3292 11.2422 12.7432C11.2422 14.3999 9.89894 15.7432 8.24219 15.7432H5.24219C3.58536 15.7432 2.24219 14.3999 2.24219 12.7432V5.24316ZM7.49219 8.99316C7.49219 8.57916 7.82819 8.24316 8.24219 8.24316H13.9144L12.4377 6.74316L13.4922 5.68866L16.2814 8.45391C16.5739 8.74716 16.5739 9.23915 16.2814 9.5324L13.4922 12.2977L12.4377 11.2432L13.9144 9.74316H8.24219C7.82819 9.74316 7.49219 9.40716 7.49219 8.99316Z",fill:"white",fillOpacity:"0.8"})}),_t=({state:e,signIn:t,enableTrading:s,loading:n,disabled:i,showLedgerButton:a})=>{let{t:c}=_();return e<=j.NotSignedIn?r.jsxs(M,{direction:"column",gap:3,className:"oui-w-full",children:[r.jsx(X,{fullWidth:!0,onClick:()=>t(),loading:n,disabled:i,children:c("connector.createAccount")}),a&&r.jsx(ue,{onClick:()=>t(),content:c("connector.createAccountWithLedger")})]}):r.jsxs(M,{direction:"column",gap:3,className:"oui-w-full",children:[r.jsx(X,{fullWidth:!0,onClick:()=>s(),loading:n,disabled:i,children:c("connector.enableTrading")}),a&&r.jsx(ue,{onClick:()=>s(),disabled:i,content:c("connector.enableTradingWithLedger")})]})},ue=({onClick:e,disabled:t,content:s})=>{let{t:n}=_(),{state:i}=V(),a=i.address,{setLedgerAddress:c}=Ce();return a?r.jsx(X,{variant:"outlined",color:"primary",fullWidth:!0,onClick:()=>{c(a),e()},disabled:t,className:"oui-w-full",children:s}):null},Mt=e=>{let{t}=_();return r.jsx(et,{placeholder:t("connector.referralCode.placeholder"),fullWidth:!0,label:"",value:e.refCode,onChange:s=>{let n=s.target.value.toUpperCase().replace(/[^A-Z0-9]/g,"");e.setRefCode(n)},classNames:{label:"oui-text-base-contrast-54 oui-text-xs",input:"placeholder:oui-text-base-contrast-20 placeholder:oui-text-sm"},formatters:[ie.createRegexInputFormatter(s=>String(s).replace(/[a-z]/g,n=>n.toUpperCase())),ie.createRegexInputFormatter(/[^A-Z0-9]/g)],onClear:()=>{e.setRefCode("")},autoComplete:"off",helpText:e.helpText,className:"oui-mb-4",color:e.helpText?"danger":void 0})},zt=()=>{let{t:e}=_(),t=()=>{window.innerWidth>768||ne.alert({title:e("connector.rememberMe"),message:r.jsx("span",{className:"oui-text-2xs oui-text-base-contrast/60",children:e("connector.rememberMe.description")})})};return r.jsx(we,{content:e("connector.rememberMe.description"),className:"oui-max-w-[300px]",children:r.jsx("button",{onClick:t,children:r.jsx(z,{intensity:54,size:"xs",className:"oui-underline oui-underline-offset-4 oui-decoration-dashed oui-decoration-base-contrast-36",children:e("connector.rememberMe")})})})};function de(e){Object.keys(e).forEach(s=>{});let t=B.t("connector.somethingWentWrong");return e.toString().includes("rejected")&&(t=B.t("connector.userRejected")),st(t)??t}var Vt=()=>{let{account:e,state:t,createOrderlyKey:s,createAccount:n}=V(),[i,a]=p.useState(""),[c,l]=p.useState(""),{t:f}=_(),{trigger:d}=Ze(`/v1/public/referral/verify_ref_code?referral_code=${i}`);p.useEffect(()=>{let C=localStorage.getItem("referral_code");C!=null&&a(C)},[]);let{referral_code:u,isLoading:y}=qe(e.accountId),[m,{error:v,isMutating:b}]=Ke("/v1/referral/bind","POST");p.useEffect(()=>{i.length===0&&l("")},[i]);let h=()=>{U.success(f("connector.walletConnected")),i.length>=4&&i.length<=10&&m({referral_code:i}).finally(()=>{localStorage.removeItem("referral_code")})},w=async()=>{if(i.length===0)return Promise.resolve(void 0);if(i.length>0&&(i.length<4||i.length>10))return Promise.resolve(f("connector.referralCode.invalid"));let{exist:C}=await d();return C===!1?Promise.resolve(f("connector.referralCode.notExist")):Promise.resolve(void 0)},x=((u==null?void 0:u.length)||0)===0&&!y,k=async()=>{if(x){let C=await w();if(typeof C<"u")return l(C),Promise.reject(-1)}return l(""),n()};return{enableTrading:async C=>{if(x){let T=await w();if(typeof T<"u")return l(T),Promise.reject(-1)}return l(""),s(C)},initAccountState:t.status,signIn:k,enableTradingComplted:h,refCode:i,setRefCode:a,helpText:c,showRefCodeInput:x}},Ee="walletConnector",Ie="walletConnectorSheet",Ae=e=>{let t=Vt();return r.jsx(Ot,{...t,...e})};be(Ee,Ae,{size:"sm",title:()=>B.t("connector.connectWallet")});xe(Ie,Ae,{title:()=>B.t("connector.connectWallet")});var se=e=>{let{status:t,buttonProps:s,fallback:n,descriptions:i,classNames:a,networkId:c,id:l,bridgeLessOnly:f}=e,{t:d}=_(),{state:u}=V(),{wrongNetwork:y,disabledConnect:m}=G(),v=p.useMemo(()=>t===void 0?u.status===j.EnableTradingWithoutConnected?j.EnableTradingWithoutConnected:j.EnableTrading:t,[t,u.status]),b={connectWallet:d("connector.connectWallet"),switchChain:d("connector.wrongNetwork"),enableTrading:d("connector.enableTrading"),signin:d("connector.createAccount"),...e.labels},h=p.useMemo(()=>typeof n<"u"?n({validating:u.validating,status:u.status,wrongNetwork:y}):u.validating&&!m?r.jsx(H,{angle:45,disabled:!0,loading:!0,description:i==null?void 0:i.connectWallet,id:l,type:"button",...s,children:b.connectWallet}):r.jsx(Dt,{bridgeLessOnly:f,status:u.status,buttonProps:{...s,id:l,type:"button"},wrongNetwork:y,networkId:e.networkId,labels:b,descriptions:i,disabledConnect:m}),[u.status,u.validating,s,y]);return r.jsx(De,{value:u.status>=v&&!y&&!m,left:h,children:e.children})},Pt=()=>{let{t:e}=_(),{state:t}=V();return t.status<j.SignedIn?r.jsx(z,{children:e("connector.createAccount")}):t.status<j.EnableTrading?r.jsx(z,{children:e("connector.enableTrading")}):r.jsx(z,{children:e("connector.connectWallet")})},Dt=e=>{let{buttonProps:t,labels:s,descriptions:n}=e,{t:i}=_(),{connectWallet:a}=G(),{account:c}=V(),{isMobile:l}=Re(),f=Be(He),d=()=>{ne.show(f?Ie:Ee,{title:r.jsx(Pt,{})}).then(m=>{},m=>{})},u=async()=>{let m=await a();m&&(m.wrongNetwork?y():((m==null?void 0:m.status)??j.NotConnected)<j.EnableTrading&&d())},y=()=>{c.once("validate:end",m=>{m<j.EnableTrading?d():U.success(i("connector.walletConnected"))}),ne.show(l?Te:ke,{networkId:e.networkId,bridgeLessOnly:e.bridgeLessOnly}).then(m=>{m.wrongNetwork||e.status>=j.Connected&&(e.status<j.EnableTrading?d():U.success(i("connector.walletConnected")))},m=>{})};return e.wrongNetwork&&!e.disabledConnect?r.jsx(H,{color:"warning",onClick:()=>{y()},description:n==null?void 0:n.switchChain,...t,children:s.switchChain}):e.status<=j.NotConnected||e.disabledConnect?r.jsx(H,{size:"lg",onClick:()=>{u()},variant:e.disabledConnect?void 0:"gradient",angle:45,description:n==null?void 0:n.connectWallet,disabled:e.disabledConnect,...t,children:s.connectWallet}):e.status<=j.NotSignedIn?r.jsx(H,{size:"lg",onClick:()=>{d()},angle:45,description:n==null?void 0:n.signin,...t,children:s.signin}):r.jsx(H,{size:"lg",description:n==null?void 0:n.enableTrading,...t,onClick:()=>d(),children:s.enableTrading})};se.displayName="AuthGuard";var H=e=>{let{description:t,...s}=e;return r.jsxs(M,{direction:"column",children:[r.jsx(X,{...s}),!!t&&r.jsx($,{mt:4,className:"oui-leading-none",style:{lineHeight:0},children:r.jsx(z,{size:"2xs",intensity:36,children:t})})]})},Kt=e=>{var v;let{status:t,labels:s,description:n,dataSource:i,children:a,...c}=e,{state:l}=V(),{wrongNetwork:f,disabledConnect:d}=G(),u=p.useMemo(()=>t===void 0?l.status===j.EnableTradingWithoutConnected?j.EnableTradingWithoutConnected:j.EnableTrading:t,[t,l.status]),y=at(i,{accountStatus:u}),m=f||d||l.status<u||e.ignoreLoadingCheck;return r.jsx(Fe,{dataSource:y,ignoreLoadingCheck:m,emptyView:r.jsx(Rt,{status:u,description:n,labels:s,className:(v=e.classNames)==null?void 0:v.authGuardDescription,visible:!l.validating}),manualPagination:!0,...c,children:a})},Rt=e=>{let{t}=_(),s={connectWallet:t("connector.trade.connectWallet.tooltip"),switchChain:t("connector.wrongNetwork.tooltip"),enableTrading:t("connector.trade.enableTrading.tooltip"),signin:t("connector.trade.createAccount.tooltip"),...e.description};return e.visible?r.jsx(M,{py:8,children:r.jsx(se,{status:e.status,labels:e.labels,descriptions:s,buttonProps:{size:"md"},children:r.jsx(Ue,{position:Ge.EmptyDataIdentifier})})}):null},Bt=e=>{let{t}=_(),{hint:s={connectWallet:t("connector.trade.connectWallet.tooltip"),signIn:t("connector.trade.createAccount.tooltip"),enableTrading:t("connector.trade.enableTrading.tooltip"),wrongNetwork:t("connector.wrongNetwork.tooltip")},status:n}=e;return r.jsx($,{my:8,children:r.jsx(se,{status:n,descriptions:{...s,switchChain:s.wrongNetwork},children:e.children||r.jsx(rt,{})})})};Bt.displayName="AuthGuardEmpty";var Ht=e=>{let{t}=_(),{opactiy:s=90,tooltip:n={connectWallet:t("connector.setUp.connectWallet.tooltip"),signIn:t("connector.setUp.createAccount.tooltip"),enableTrading:t("connector.setUp.enableTrading.tooltip"),wrongNetwork:t("connector.wrongNetwork.tooltip")}}=e,[i,a]=p.useState(!1),{state:c}=V(),l=!0,{wrongNetwork:f}=G(),d=p.useMemo(()=>{if(f)return n==null?void 0:n.wrongNetwork;switch(c.status){case j.NotConnected:return n==null?void 0:n.connectWallet;case j.NotSignedIn:return n==null?void 0:n.signIn;case j.DisabledTrading:return n==null?void 0:n.enableTrading;case j.EnableTrading:return"";default:return e.content}},[e.content,c,l,n]),u=p.useMemo(()=>{switch(c.status){case j.NotConnected:case j.NotSignedIn:return s;case j.EnableTrading:return;default:return}},[e.opactiy,c,l]);return r.jsx(we,{open:d?i:!1,onOpenChange:a,content:d,className:"oui-text-2xs",align:e.align,alignOffset:e.alignOffset,side:e.side,sideOffset:e.sideOffset,children:r.jsx("div",{style:{opacity:u},children:e.children})})};Ht.displayName="AuthGuardTooltip";export{se as A,Ie as D,ke as F,je as I,Ee as O,qt as T,Te as a,Bt as h,Ht as w,Kt as y};
