import{I as _e,bK as wi,bL as Ci,l as ee,a as j,Q as Ni,L as p,W,M as K,G as O,ap as ht,ar as Ae,k as Ue,bq as _i,N as J,t as de,q as u,au as F,bM as ae,aI as B,bN as Ai,bO as gt,bC as Be,bD as ft,b2 as le,bP as ki,bQ as bt,bR as Y,e as oe,bS as Pe,bT as ke,j as me,bU as jt,bV as vt,d as yt,ah as Q,a8 as qe,bW as Ii,a6 as T,a4 as R,v as Ke,bu as ue,x as Fe,b as $,O as Ze,K as q,bX as we,bY as wt,bZ as Xe,b_ as Ye,a5 as Ct,bw as pe,bx as Si,bz as zi,b$ as Mi,c0 as Nt,c1 as Ri,s as _t,c2 as Ti,c3 as Ei,c4 as Di,c5 as Pi,c6 as Ki,ak as Re,c7 as ve,al as We,X as Fi,S as nt,Y as lt,_ as Li,Z as Oi,ag as At,a1 as Wi,R as Hi,F as Vi,aa as $i,c8 as Ui,c9 as kt,aq as Bi,ca as qi,V as De,a9 as ye,cb as Zi,cc as Xi,cd as Yi,a3 as It,ce as Qe,an as Ie,cf as Qi,cg as Gi,ch as Ji,ci as eo,ad as to,cj as io,h as oo,aH as Ge,ck as St,bf as Je,cl as ct,cm as ut,bt as ao,cn as so,bm as zt,co as Mt,cp as He,cq as dt,cr as ro,a_ as no,bs as lo}from"./index-B1yGdhtz.js";import{r as d,W as P}from"./index-TjLUG_Bo.js";import{$ as Rt,h as co,b as uo,T as mo,K as po,H as xo}from"./index-DCRsf1dF.js";import{j as e}from"./jsx-runtime-DF5SV9au.js";import{D as te,_ as Ce}from"./index-BHYcTakE.js";import{F as Tt,M as ho,q as go,f as fo,H as bo,Q as jo,I as Et,a as vo,d as Dt,u as yo,b as wo}from"./index-BgbMmrC1.js";import{A as Co,y as xe,w as et,h as No,T as _o}from"./index-7JkPJWjm.js";import{z as Ao,c as ko,F as Io}from"./index-BH3VCfp0.js";import{d as So}from"./differenceInDays-f7lEgFzC.js";function he(t){return _e(t).getDate()}function ge(t){return _e(t).getMonth()}function fe(t){return _e(t).getFullYear()}function Se(t,i){let o=_e(t);return isNaN(+o)?wi(t,NaN):(i.year!=null&&o.setFullYear(i.year),i.month!=null&&(o=Ci(o,i.month)),i.date!=null&&o.setDate(i.date),i.hours!=null&&o.setHours(i.hours),i.minutes!=null&&o.setMinutes(i.minutes),i.seconds!=null&&o.setSeconds(i.seconds),i.milliseconds!=null&&o.setMilliseconds(i.milliseconds),o)}function zo(t,i){const o=_e(t);return o.setHours(i),o}var Mo=Object.defineProperty,re=(t,i)=>{for(var o in i)Mo(t,o,{get:i[o],enumerable:!0})},Ro=(t=>(t.Overview="/portfolio",t.Positions="/portfolio/positions",t.Orders="/portfolio/orders",t.Assets="/portfolio/assets",t.FeeTier="/portfolio/feeTier",t.ApiKey="/portfolio/apiKey",t.Setting="/portfolio/setting",t.History="/portfolio/history",t))(Ro||{}),To=t=>{let{routerAdapter:i}=Rt(),[o,s]=d.useState(t.current??(i==null?void 0:i.currentPath)??"/portfolio"),{t:a}=j();d.useEffect(()=>{(o||i!=null&&i.currentPath)&&s(o||(i==null?void 0:i.currentPath)||"/portfolio")},[o,i==null?void 0:i.currentPath]);let r=d.useMemo(()=>[{name:a("common.overview"),href:"/portfolio",icon:e.jsx("svg",{width:"18",height:"18",viewBox:"0 0 18 18",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M5.24316 2.19727C3.58641 2.19727 2.24316 3.54044 2.24316 5.19727V12.6973C2.24316 14.3541 3.58641 15.6973 5.24316 15.6973H12.7432C14.3999 15.6973 15.7432 14.3541 15.7432 12.6973V5.19727C15.7432 3.54044 14.3999 2.19727 12.7432 2.19727H5.24316ZM5.24316 3.69727H12.7432C13.5719 3.69727 14.2432 4.36882 14.2432 5.19727V12.6973C14.2432 13.2484 13.9319 13.734 13.4894 13.9947C13.3454 12.2235 11.4427 11.1973 8.99316 11.1973C6.54366 11.1973 4.60341 12.251 4.48566 13.9997C4.04241 13.739 3.74316 13.2484 3.74316 12.6973V5.19727C3.74316 4.36882 4.41441 3.69727 5.24316 3.69727ZM8.99316 5.19727C7.54341 5.19727 6.36816 6.37252 6.36816 7.82227C6.36816 9.27202 7.54341 10.4473 8.99316 10.4473C10.4429 10.4473 11.6182 9.27202 11.6182 7.82227C11.6182 6.37252 10.4429 5.19727 8.99316 5.19727Z",className:"oui-fill-current group-data-[actived=true]:oui-fill-[url(#side-menu-gradient)]"})})},{name:a("common.positions"),href:"/portfolio/positions",icon:e.jsx("svg",{width:"18",height:"18",viewBox:"0 0 18 18",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M4.51 3.021a3 3 0 0 0-3 3v6a3 3 0 0 0 3 3h9a3 3 0 0 0 3-3v-6a3 3 0 0 0-3-3zm2.25 3a.76.76 0 0 1 .54.211.77.77 0 0 1 0 1.078l-.75.75a.77.77 0 0 1-.54.211h-.75a.75.75 0 0 1 0-1.5h.422l.54-.539a.76.76 0 0 1 .539-.21m3 .75h3a.75.75 0 0 1 0 1.5h-3a.75.75 0 0 1 0-1.5m-3 2.25a.76.76 0 0 1 .54.211.77.77 0 0 1 0 1.079l-.75.75a.77.77 0 0 1-.54.21h-.75a.75.75 0 0 1 0-1.5h.422l.54-.539a.76.76 0 0 1 .539-.21m3 .75h3a.75.75 0 0 1 0 1.5h-3a.75.75 0 0 1 0-1.5",className:"oui-fill-current group-data-[actived=true]:oui-fill-[url(#side-menu-gradient)]"})})},{name:a("common.orders"),href:"/portfolio/orders",icon:e.jsx("svg",{width:"18",height:"18",viewBox:"0 0 18 18",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M5.693 1.5C4.229 1.5 3.02 2.61 3.02 4.006v9.984c0 1.398 1.208 2.508 2.672 2.508h6.657c1.463 0 2.671-1.11 2.671-2.508V6.726c0-2.672-2.579-5.227-5.25-5.227zm4.828 1.593c1.33.352 2.562 1.58 2.906 2.906h-1.734c-.667 0-1.172-.472-1.172-1.008zm-3.75 2.906h.75a.75.75 0 0 1 0 1.5h-.75a.75.75 0 0 1 0-1.5m0 3h4.5a.75.75 0 0 1 0 1.5h-4.5a.75.75 0 0 1 0-1.5m0 3h4.5a.75.75 0 0 1 0 1.5h-4.5a.75.75 0 0 1 0-1.5",className:"oui-fill-current group-data-[actived=true]:oui-fill-[url(#side-menu-gradient)]"})})},{name:a("common.assets"),href:"/portfolio/assets",icon:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 18 18",fill:"none",children:e.jsx("path",{d:"M9 1.5C4.85 1.5 1.5 4.85 1.5 9C1.5 13.15 4.85 16.5 9 16.5C13.15 16.5 16.5 13.15 16.5 9C16.5 4.85 13.15 1.5 9 1.5ZM8.17529 3.75H9.67529V4.94971L10.125 5.17529C10.35 5.32529 10.5756 5.47471 10.7256 5.69971C10.8756 5.92471 11.0256 6.14971 11.1006 6.44971C11.1756 6.74971 11.25 7.05029 11.25 7.42529H9.82471C9.82471 6.97529 9.75059 6.67471 9.60059 6.44971C9.45059 6.22471 9.3 6.14941 9 6.14941C8.85 6.14941 8.7 6.15059 8.625 6.22559L8.39941 6.44971C8.32441 6.52471 8.325 6.675 8.25 6.75C8.175 6.825 8.17529 6.975 8.17529 7.125C8.17529 7.275 8.25 7.35 8.25 7.5C8.25 7.65 8.32441 7.72529 8.39941 7.80029C8.47441 7.95029 8.54971 8.02559 8.69971 8.10059C8.77471 8.17559 8.92441 8.24971 9.14941 8.32471C9.44941 8.47471 9.75059 8.62441 9.97559 8.77441C10.2756 8.92441 10.4994 9.07529 10.6494 9.30029C10.8744 9.52529 11.0256 9.75059 11.1006 9.97559C11.1756 10.2006 11.25 10.5 11.25 10.875C11.25 11.25 11.1756 11.5494 11.1006 11.7744C11.0256 12.0744 10.8756 12.2247 10.7256 12.4497C10.5756 12.5997 10.35 12.7494 10.125 12.8994C9.975 12.9744 9.9 13.0503 9.75 13.0503V14.25H8.25V12.9756C8.1 12.9006 7.95029 12.8997 7.80029 12.8247C7.50029 12.7497 7.35 12.6 7.125 12.375C6.975 12.225 6.82529 11.925 6.67529 11.625C6.60029 11.25 6.52441 10.8753 6.52441 10.4253H8.02441C8.02441 10.6503 8.02559 10.8756 8.10059 11.1006C8.17559 11.3256 8.24971 11.4753 8.32471 11.5503C8.39971 11.6253 8.475 11.6994 8.625 11.7744C8.775 11.8494 8.85 11.8506 9 11.8506C9.15 11.8506 9.225 11.8494 9.375 11.7744C9.525 11.6994 9.60029 11.6253 9.67529 11.5503C9.75029 11.4753 9.74971 11.4 9.82471 11.25C9.89971 11.175 9.89941 11.025 9.89941 10.875C9.89941 10.725 9.82471 10.575 9.82471 10.5C9.82471 10.425 9.75029 10.2747 9.67529 10.1997C9.60029 10.0497 9.525 9.97441 9.375 9.89941L8.92529 9.67529C8.62529 9.52529 8.32559 9.37559 8.10059 9.22559C7.80059 9.07559 7.57529 8.92471 7.42529 8.69971C7.20029 8.54971 7.05059 8.32441 6.97559 8.02441C6.90059 7.79941 6.82471 7.5 6.82471 7.125C6.82471 6.825 6.82441 6.52529 6.89941 6.30029C7.04941 6.07529 7.12559 5.85 7.35059 5.625C7.50059 5.4 7.65029 5.25029 7.80029 5.17529C7.95029 5.10029 8.02529 5.02441 8.17529 5.02441V3.75Z",className:"oui-fill-current group-data-[actived=true]:oui-fill-[url(#side-menu-gradient)]"})})},{name:a("portfolio.feeTier"),href:"/portfolio/feeTier",icon:e.jsx("svg",{width:"18",height:"18",viewBox:"0 0 18 18",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M5.99829 1.51062C4.34154 1.51062 2.99829 2.85387 2.99829 4.51062V13.5106C2.99829 15.1674 4.34154 16.5106 5.99829 16.5106H11.9983C13.655 16.5106 14.9983 15.1674 14.9983 13.5106V4.51062C14.9983 2.85387 13.655 1.51062 11.9983 1.51062H5.99829ZM5.99829 3.76062H11.9983C12.4123 3.76062 12.7483 4.09662 12.7483 4.51062V6.01062C12.7483 6.42462 12.4123 6.76062 11.9983 6.76062H5.99829C5.58429 6.76062 5.24829 6.42462 5.24829 6.01062V4.51062C5.24829 4.09662 5.58429 3.76062 5.99829 3.76062ZM5.99829 8.26062C6.41229 8.26062 6.74829 8.59662 6.74829 9.01062C6.74829 9.42462 6.41229 9.76062 5.99829 9.76062C5.58429 9.76062 5.24829 9.42462 5.24829 9.01062C5.24829 8.59662 5.58429 8.26062 5.99829 8.26062ZM8.99829 8.26062C9.41229 8.26062 9.74829 8.59662 9.74829 9.01062C9.74829 9.42462 9.41229 9.76062 8.99829 9.76062C8.58429 9.76062 8.24829 9.42462 8.24829 9.01062C8.24829 8.59662 8.58429 8.26062 8.99829 8.26062ZM11.9983 8.26062C12.4123 8.26062 12.7483 8.59662 12.7483 9.01062C12.7483 9.42462 12.4123 9.76062 11.9983 9.76062C11.5843 9.76062 11.2483 9.42462 11.2483 9.01062C11.2483 8.59662 11.5843 8.26062 11.9983 8.26062ZM5.99829 10.5106C6.41229 10.5106 6.74829 10.8466 6.74829 11.2606C6.74829 11.6746 6.41229 12.0106 5.99829 12.0106C5.58429 12.0106 5.24829 11.6746 5.24829 11.2606C5.24829 10.8466 5.58429 10.5106 5.99829 10.5106ZM8.99829 10.5106C9.41229 10.5106 9.74829 10.8466 9.74829 11.2606C9.74829 11.6746 9.41229 12.0106 8.99829 12.0106C8.58429 12.0106 8.24829 11.6746 8.24829 11.2606C8.24829 10.8466 8.58429 10.5106 8.99829 10.5106ZM11.9983 10.5106C12.4123 10.5106 12.7483 10.8466 12.7483 11.2606V13.5106C12.7483 13.9246 12.4123 14.2606 11.9983 14.2606C11.5843 14.2606 11.2483 13.9246 11.2483 13.5106V11.2606C11.2483 10.8466 11.5843 10.5106 11.9983 10.5106ZM5.99829 12.7606C6.41229 12.7606 6.74829 13.0966 6.74829 13.5106C6.74829 13.9246 6.41229 14.2606 5.99829 14.2606C5.58429 14.2606 5.24829 13.9246 5.24829 13.5106C5.24829 13.0966 5.58429 12.7606 5.99829 12.7606ZM8.99829 12.7606C9.41229 12.7606 9.74829 13.0966 9.74829 13.5106C9.74829 13.9246 9.41229 14.2606 8.99829 14.2606C8.58429 14.2606 8.24829 13.9246 8.24829 13.5106C8.24829 13.0966 8.58429 12.7606 8.99829 12.7606Z",className:"oui-fill-current group-data-[actived=true]:oui-fill-[url(#side-menu-gradient)]"})})},{name:a("portfolio.apiKeys"),href:"/portfolio/apiKey",icon:e.jsx("svg",{width:"18",height:"18",viewBox:"0 0 18 18",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M9.02124 1.49915C7.77849 1.49915 6.77124 2.5064 6.77124 3.74915C6.77124 4.70015 7.40049 5.55517 8.26974 5.86942L8.27124 8.24915H5.27124C4.85724 8.24915 4.52124 8.58515 4.52124 8.99915L4.52048 12.1304C3.65723 12.4274 3.02124 13.2981 3.02124 14.2491C3.02124 15.4919 4.02849 16.4991 5.27124 16.4991C6.51399 16.4991 7.52124 15.4919 7.52124 14.2491C7.52124 13.2981 6.92499 12.4596 6.02949 12.1206L6.02124 9.74915H9.02124H12.0212L12.0265 12.1319C11.1257 12.4446 10.5212 13.2981 10.5212 14.2491C10.5212 15.4919 11.5285 16.4991 12.7712 16.4991C14.014 16.4991 15.0212 15.4919 15.0212 14.2491C15.0212 13.2981 14.407 12.4611 13.5272 12.1281L13.5212 8.99915C13.5212 8.58515 13.1852 8.24915 12.7712 8.24915H9.77124L9.76899 5.86639C10.642 5.55814 11.2712 4.70015 11.2712 3.74915C11.2712 2.5064 10.264 1.49915 9.02124 1.49915Z",className:"oui-fill-current group-data-[actived=true]:oui-fill-[url(#side-menu-gradient)]"})})},{name:a("portfolio.setting"),href:"/portfolio/setting",icon:e.jsx("svg",{width:"18",height:"18",viewBox:"0 0 18 18",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M6.72601 1.84159C5.66251 2.17834 4.74527 2.7296 3.93677 3.48185C3.68702 3.7151 3.61052 4.09534 3.77252 4.39609C4.37327 5.50684 3.74476 6.69484 2.39026 6.76309C2.05801 6.78034 1.76477 7.02559 1.68677 7.34884C1.55252 7.90759 1.49927 8.37559 1.49927 8.98984C1.49927 9.50509 1.55476 10.0878 1.66351 10.6068C1.73101 10.9308 2.01302 11.1641 2.34302 11.1933C3.70652 11.3111 4.38152 12.3506 3.77252 13.6773C3.63752 13.9721 3.69902 14.3246 3.93677 14.5443C4.73327 15.2816 5.64826 15.8006 6.72601 16.1381C7.03351 16.2348 7.38076 16.1186 7.56976 15.8568C8.40376 14.7033 9.61352 14.6988 10.4055 15.8568C10.5923 16.1298 10.9343 16.2611 11.2493 16.1613C12.2895 15.8343 13.2585 15.2771 14.0618 14.5443C14.3093 14.3193 14.3745 13.9541 14.226 13.6541C13.602 12.3948 14.3198 11.2383 15.6083 11.2166C15.9503 11.2106 16.2548 10.9856 16.335 10.6541C16.4648 10.1163 16.4993 9.64759 16.4993 8.98984C16.4993 8.42434 16.4325 7.86709 16.3118 7.32559C16.2353 6.98359 15.936 6.74059 15.585 6.73984C14.3168 6.73759 13.6058 5.49109 14.226 4.39609C14.3985 4.09084 14.3445 3.71735 14.085 3.48185C13.2675 2.73935 12.2708 2.15959 11.226 1.84159C10.905 1.74409 10.5638 1.86409 10.3823 2.14609C9.65776 3.27109 8.30477 3.29135 7.59302 2.16935C7.41077 1.8821 7.05001 1.73809 6.72601 1.84159ZM8.99927 5.98984C10.656 5.98984 11.9993 7.33309 11.9993 8.98984C11.9993 10.6466 10.656 11.9898 8.99927 11.9898C7.34252 11.9898 5.99927 10.6466 5.99927 8.98984C5.99927 7.33309 7.34252 5.98984 8.99927 5.98984Z",className:"oui-fill-current group-data-[actived=true]:oui-fill-[url(#side-menu-gradient)]"})})},{name:a("trading.history"),href:"/portfolio/history",hide:!0}],[a]),n=Ni("(max-width: 768px)");return{items:r,current:o,hideSideBar:n,onItemSelect:c=>{typeof c.href>"u"||(s(c.href),i==null||i.onRouteChange({href:c.href,name:c.name}))}}},Eo=t=>{var r;let{children:i,leftSideProps:o,classNames:s,...a}=t;return e.jsx(mo,{leftSidebar:t.hideSideBar?null:e.jsx(Do,{current:(r=t.routerAdapter)==null?void 0:r.currentPath,routerAdapter:t.routerAdapter,items:t.items,...o}),routerAdapter:t.routerAdapter,classNames:{...s,content:K("oui-my-6 oui-px-3",s==null?void 0:s.content),topNavbar:K("oui-bg-base-9",s==null?void 0:s.topNavbar),leftSidebar:K("oui-rounded-xl oui-bg-base-9","oui-m-3 oui-p-4","oui-border oui-border-line",s==null?void 0:s.leftSidebar)},...a,children:i})},Do=t=>{let{expanded:i,setExpand:o}=Rt(),{t:s}=j();return e.jsx(po,{title:s("common.portfolio"),...t,open:i,onOpenChange:a=>o(a),onItemSelect:a=>{var r,n,c;(r=t.onItemSelect)==null||r.call(t,a),(c=(n=t.routerAdapter)==null?void 0:n.onRouteChange)==null||c.call(n,{href:a.href||"",name:a.name})}})},Pt=d.createContext({sideOpen:!0}),Po=()=>d.useContext(Pt),Ko=t=>{let[i,o]=d.useState(!0),s=d.useMemo(()=>({sideOpen:i,onSideOpenChange:o,routerAdapter:t.routerAdapter}),[i,o,t.routerAdapter]);return e.jsx(Pt.Provider,{value:s,children:t.children})},Fo=t=>{var i,o;return e.jsx(Ko,{...t,children:e.jsxs(p,{direction:"column",width:"100%",height:"100%",className:"oui-h-full-screen oui-bg-base-10",children:[e.jsx("header",{className:"oui-sticky oui-top-0 oui-z-10 oui-w-full oui-bg-base-10",children:e.jsx(co,{...t.mainNavProps,current:t==null?void 0:t.current,subItems:t==null?void 0:t.items,routerAdapter:t.routerAdapter})}),e.jsx(W,{className:"oui-min-h-[calc(100vh-44px-64px-env(safe-area-inset-bottom))] oui-w-full",children:t.children}),e.jsx("footer",{className:"oui-sticky oui-bottom-0 oui-z-10 oui-w-full oui-bg-base-9 oui-pb-[calc(env(safe-area-inset-bottom))]",children:e.jsx(uo,{mainMenus:(i=t.bottomNavProps)==null?void 0:i.mainMenus,current:t==null?void 0:t.current,onRouteChange:(o=t.routerAdapter)==null?void 0:o.onRouteChange})})]})})},Ks=t=>{var s;let i=To({current:(s=t.leftSideProps)==null?void 0:s.current}),{isMobile:o}=ee();return e.jsx(e.Fragment,{children:o?e.jsx(Fo,{...i,...t}):e.jsx(Eo,{...i,...t})})},Lo={};re(Lo,{AssetHistory:()=>Ht,AssetHistoryWidget:()=>Ne,AssetWidget:()=>Lt,AssetsChart:()=>ti,AssetsChartWidget:()=>ii,AssetsUI:()=>Ft,DistributionHistoryDesktop:()=>Vt,DistributionHistoryMobile:()=>$t,DistributionHistoryWidget:()=>tt,FundingHistoryWidget:()=>it,HistoryDataGroupWidget:()=>Le,OverviewContextProvider:()=>Gt,OverviewPage:()=>Pa,PerformanceUI:()=>oi,PerformanceWidget:()=>si,useAssetHistoryColumns:()=>Ot,useAssetHistoryScript:()=>Wt,useAssetsChartScript:()=>Jt,useFundingHistoryColumns:()=>Ut,useFundingHistoryHook:()=>Bt,usePerformanceScript:()=>ai});var Kt=()=>{let{connect:t,namespace:i}=Ct(),{state:o,isMainAccount:s}=T(),{totalValue:a,freeCollateral:r}=pe(),{wrongNetwork:n,disabledConnect:c}=te(),[l]=Si(),{curLeverage:m}=zi(),[h,f]=Ke("orderly_assets_visible",!0),{isMobile:g}=ee(),x=g?Tt:Et,b=d.useMemo(()=>!n&&!c&&(o.status===R.EnableTrading||o.status===R.EnableTradingWithoutConnected),[o.status,n,c]),w=()=>{O.show(wo)},C=d.useCallback(()=>{O.show(x,{activeTab:"deposit"})},[x]),y=d.useCallback(()=>{O.show(x,{activeTab:"withdraw"})},[]),S=d.useCallback(()=>{g?O.show(vo):O.show(Dt)},[g]);return{canTrade:b,connect:t,portfolioValue:a,freeCollateral:r,unrealPnL:l.aggregated.total_unreal_pnl,unrealROI:l.totalUnrealizedROI,currentLeverage:m,onLeverageEdit:w,visible:h,wrongNetwork:n,toggleVisible:()=>f(!h),onDeposit:C,onWithdraw:y,onTransfer:S,namespace:i,isMainAccount:s}},Oo=t=>{let{t:i}=j();return e.jsxs(p,{justify:"between",children:[e.jsx(wt,{children:i("common.overview")}),t.isMainAccount?e.jsxs(p,{gap:3,children:[e.jsx(q,{disabled:t.disabled,size:"md",color:"secondary",onClick:()=>{var o;return(o=t.onWithdraw)==null?void 0:o.call(t)},icon:e.jsx(Xe,{}),"data-testid":"oui-testid-portfolio-assets-withdraw-btn",children:i("common.withdraw")}),e.jsx(q,{disabled:t.disabled,size:"md",onClick:()=>{var o;return(o=t.onDeposit)==null?void 0:o.call(t)},icon:e.jsx(Ye,{}),"data-testid":"oui-testid-portfolio-assets-deposit-btn",children:i("common.deposit")})]}):e.jsx(q,{disabled:t.disabled,size:"md",color:"secondary",onClick:()=>{var o;return(o=t.onTransfer)==null?void 0:o.call(t)},children:i("common.transfer")})]})},Ft=t=>{let{t:i}=j();return e.jsx(ae,{classNames:{footer:"oui-h-[48px]",root:"oui-h-[240px]"},title:e.jsx(Oo,{disabled:!t.canTrade,isMainAccount:t.isMainAccount,onDeposit:t.onDeposit,onWithdraw:t.onWithdraw,onTransfer:t.onTransfer}),children:e.jsxs(e.Fragment,{children:[e.jsx(B,{label:e.jsxs(p,{gap:1,children:[e.jsx(u,{intensity:54,children:i("common.totalValue")}),e.jsx("button",{onClick:()=>{t.toggleVisible()},"data-testid":"oui-testid-portfolio-assets-eye-btn",children:t.visible?e.jsx(Be,{size:16,color:"white"}):e.jsx(ft,{size:16,color:"white"})})]}),children:e.jsx(Ai,{value:t.canTrade,left:e.jsx(Wo,{}),children:e.jsx(u.numeral,{visible:t.visible,unit:"USDC",style:{"--oui-gradient-angle":"45deg"},unitClassName:"oui-text-base oui-text-base-contrast-80 oui-h-9 oui-ml-1",className:gt({className:"oui-font-bold oui-text-3xl",color:"brand"}),children:t.portfolioValue??"--"})})}),e.jsx(de,{className:"oui-my-4",intensity:8}),e.jsx(Co,{buttonProps:{size:"lg",fullWidth:!0},children:e.jsx(Ho,{unrealROI:t.unrealROI,unrealPnL:t.unrealPnL,freeCollateral:t.freeCollateral,currentLeverage:t.currentLeverage,onLeverageEdit:t.onLeverageEdit,visible:t.visible})})]})})},Wo=()=>e.jsxs(p,{gap:1,className:"oui-h-9",children:[e.jsx(u.gradient,{color:"brand",weight:"bold",children:"--"}),e.jsx(u,{children:"USDC"})]}),Ho=t=>{let{t:i}=j();return e.jsxs(le,{cols:3,className:"oui-h-12",children:[e.jsx(B,{label:i("common.unrealizedPnl"),children:e.jsxs(p,{children:[e.jsx(u.numeral,{coloring:!0,size:"lg",weight:"semibold",visible:t.visible,children:t.unrealPnL}),e.jsx(u.numeral,{coloring:!0,rule:"percentages",size:"sm",weight:"semibold",prefix:"(",suffix:")",visible:t.visible,children:t.unrealROI})]})}),e.jsx(B,{label:i("leverage.maxAccountLeverage"),children:e.jsxs(p,{itemAlign:"center",children:[e.jsx("span",{"data-testid":"oui-testid-portfolio-assets-maxAccountLeverage-value",className:"oui-text-lg",children:t.currentLeverage}),e.jsx("span",{children:"x"}),e.jsx("button",{className:"oui-ml-1",onClick:()=>{var o;return(o=t.onLeverageEdit)==null?void 0:o.call(t)},"data-testid":"oui-testid-portfolio-assets-maxAccountLeverage-edit-btn",children:e.jsx(ki,{color:"white",size:18})})]})}),e.jsx(B,{label:i("portfolio.overview.availableWithdraw"),align:"right",valueProps:{size:"lg",visible:t.visible},children:t.freeCollateral})]})},Lt=()=>{let{connect:t,...i}=Kt();return e.jsx(Ft,{onConnectWallet:t,connect:t,...i})},Vo=()=>{let[t,i]=d.useState("deposit");return{active:t,onTabChange:i}},$o=()=>{let{t}=j(),i=()=>{F.success(t("common.copy.copied"))},{state:o}=T(),s=o.subAccounts??[];return P.useMemo(()=>[{title:t("common.token"),dataIndex:"token",width:80,render(a){return e.jsxs(p,{gapX:2,children:[e.jsx(J,{name:a,size:"xs"}),e.jsx("span",{children:a})]})}},{title:t("common.time"),dataIndex:"updated_time",width:120,rule:"date"},{title:`${t("transfer.internalTransfer.from")} (Account ID)`,dataIndex:"from_account_id",render(a){let r=a===o.mainAccountId,n=s.find(c=>c.id===a);return e.jsxs(p,{itemAlign:"start",py:2,gap:1,direction:"column",children:[e.jsx(u.formatted,{onCopy:i,copyable:!0,rule:"address",children:a}),e.jsx(De,{className:"oui-select-none",color:"neutral",size:"xs",children:r?t("common.mainAccount"):(n==null?void 0:n.description)||t("common.subAccount")})]})}},{title:`${t("transfer.internalTransfer.to")} (Account ID)`,dataIndex:"to_account_id",render(a){let r=a===o.mainAccountId,n=s.find(c=>c.id===a);return e.jsxs(p,{itemAlign:"start",py:2,gap:1,direction:"column",children:[e.jsx(u.formatted,{onCopy:i,copyable:!0,rule:"address",children:a}),e.jsx(De,{className:"oui-select-none",color:"neutral",size:"xs",children:r?t("common.mainAccount"):(n==null?void 0:n.description)||t("common.subAccount")})]})}},{title:t("common.status"),dataIndex:"status",width:120,render(a){return ro(a)}},{title:t("common.amount"),dataIndex:"amount",width:80}],[t,o.mainAccountId,s])},Uo=t=>{let{dataSource:i,queryParameter:o,state:s,isMainAccount:a,isLoading:r,selectedAccount:n,onFilter:c}=t,{side:l,dateRange:m}=o,{t:h}=j(),f={label:h("common.allAccount"),value:"All accounts"},g={label:h("common.mainAccount"),value:"Main accounts"},x=s.subAccounts??[],b=d.useMemo(()=>Array.isArray(x)&&x.length?[f,g,...x.map(C=>({value:C.id,label:(C==null?void 0:C.description)||ue(C==null?void 0:C.id)}))]:[f,g],[x]),w=$o();return e.jsxs(e.Fragment,{children:[e.jsx(Q,{onFilter:c,items:zt([{type:"select",name:"side",value:l,options:[{value:"OUT",label:"Outflow"},{value:"IN",label:"Inflow"}]},{type:"range",name:"dateRange",value:{from:m[0],to:m[1]}}],C=>{a&&C.unshift({type:"select",name:"account",value:n,options:b})})}),e.jsx(xe,{bordered:!0,columns:w,dataSource:i,loading:r,className:"oui-font-semibold",classNames:{root:"oui-h-[calc(100%_-_49px)]"},pagination:t.pagination,generatedRowKey:C=>C.id})]})},ze=t=>{let{from:i,to:o=new Date}=t;return So(i,o)===0?[i,zo(o,23)]:[i,o]},Bo=()=>{var S,E;let t=P.useMemo(()=>{let I=new Date;return new Date(fe(I),ge(I),he(I),0,0,0)},[]),[i,o]=P.useState([ke(90,t),t]),{page:s,pageSize:a,setPage:r,parsePagination:n}=me(),{state:c}=T(),[l,m]=P.useState("All accounts"),[h,f]=P.useState("OUT"),[g,{isLoading:x,meta:b}]=vt({dataRange:[(S=i[0])==null?void 0:S.getTime(),(E=Se(i[1],{hours:23,minutes:59,seconds:59,milliseconds:0}))==null?void 0:E.getTime()],side:h,size:a,page:s,main_sub_only:!0}),w=P.useMemo(()=>g.filter(I=>!l||l==="All accounts"?!0:l==="Main accounts"?I.from_account_id===c.mainAccountId||I.to_account_id===c.mainAccountId:I.from_account_id===l||I.to_account_id===l),[g,l]),C=P.useCallback(I=>{I.name==="account"&&m(I.value),I.name==="side"&&f(I.value),I.name==="dateRange"&&o(ze(I.value)),r(1)},[r]),y=P.useMemo(()=>n(b),[n,b]);return{dataSource:w,isLoading:x,queryParameter:{side:h,dateRange:i},selectedAccount:l,onFilter:C,pagination:y}},qo=()=>{let t=Bo(),i=T();return e.jsx(Uo,{...t,...i})},Ot=t=>{let{chainsInfo:i,isDeposit:o,isWeb3Wallet:s}=t,{t:a}=j(),r=n=>{n.preventDefault(),n.stopPropagation(),F.success(a("common.copy.copied"))};return d.useMemo(()=>{let n={title:a("common.txId"),dataIndex:"tx_id",width:120,render:(l,m)=>{var f;if(!l)return e.jsx("div",{className:"oui-text-base-contrast-54",children:"-"});let h=`${(f=i==null?void 0:i.find(g=>parseInt(m.chain_id)===parseInt(g.chain_id)))==null?void 0:f.explorer_base_url}/tx/${l}`;return e.jsx("a",{href:h,target:"_blank",rel:"noreferrer",children:e.jsx(u.formatted,{copyable:!!l,rule:"txId",className:"oui-underline oui-decoration-line-16 oui-decoration-dashed oui-underline-offset-4",onCopy:r,children:l})})}},c={title:a("common.accountId"),dataIndex:"account_id",width:120,render:(l,m)=>{let h=o?m.from_account_id:m.to_account_id;return e.jsx(u.formatted,{rule:"address",copyable:!!h,onCopy:r,children:h})}};return[{title:a("common.token"),dataIndex:"token",width:80,render:l=>e.jsxs(p,{gapX:1,children:[e.jsx(J,{name:l,size:"xs"}),e.jsx("span",{children:l})]})},{title:a("common.time"),dataIndex:"created_time",width:80,rule:"date"},s?n:c,{title:a("common.status"),dataIndex:"trans_status",width:100,render:(l,m)=>(l=s?l:m.status,{[Y.NEW]:a("assetHistory.status.pending"),[Y.PENDING]:a("assetHistory.status.pending"),[Y.CONFIRM]:a("assetHistory.status.confirm"),[Y.PROCESSING]:a("assetHistory.status.processing"),[Y.COMPLETED]:a("assetHistory.status.completed"),[Y.FAILED]:a("assetHistory.status.failed")}[l]||bt(l==null?void 0:l.toLowerCase()))},{title:a("common.amount"),dataIndex:"amount",width:100,rule:"price",render:(l,m)=>{let h=new oe(l).minus(m.fee??0);return e.jsx(u.numeral,{dp:m.decimals,rule:"price",coloring:!0,showIdentifier:!0,padding:!1,children:o?h.toNumber():h.neg().toNumber()})}}]},[a,i,o,s])},Wt=t=>{let{side:i}=t,o=i===we.DEPOSIT,[s]=d.useState(()=>{let A=new Date;return new Date(fe(A),ge(A),he(A),0,0,0)}),a=Pe(),[r,n]=d.useState("Web3Wallet"),[c,l]=d.useState([ke(90,s),s]),{page:m,pageSize:h,setPage:f,parsePagination:g}=me(),{startTime:x,endTime:b}=d.useMemo(()=>{let A=c[0].getTime(),L=Se(c[1],{hours:23,minutes:59,seconds:59,milliseconds:0}).getTime();return{startTime:A,endTime:L}},[c]),[w,{meta:C,isLoading:y}]=jt({startTime:x,endTime:b,page:m,pageSize:h,side:i},{shouldUpdateOnWalletChanged:A=>A.side===i}),[S,{isLoading:E,meta:I}]=vt({dataRange:[x,b],side:o?"IN":"OUT",size:h,page:m,main_sub_only:!1}),{data:X}=yt("/v1/public/chain_info",{revalidateOnFocus:!1}),Z=A=>{A.name==="dateRange"?(l(ze(A.value)),f(1)):A.name==="target"&&(n(A.value),f(1))},v=d.useMemo(()=>r==="Web3Wallet"?y:E,[r,y,E]),z=d.useMemo(()=>r==="Web3Wallet"?C:I,[r,C,I]),_=d.useMemo(()=>g(z),[g,z]),M=d.useMemo(()=>(r==="Web3Wallet"?w:S).map(A=>{let L=a==null?void 0:a.find(({token:ie})=>ie===A.token);return{...A,decimals:(L==null?void 0:L.decimals)??2}}),[r,w,S,a]),N=d.useCallback(()=>{O.show(Tt,{activeTab:"deposit"})},[]),k=r==="Web3Wallet";return{dataSource:M,total:z==null?void 0:z.total,isLoading:v,queryParameter:{target:r,dateRange:c},onFilter:Z,pagination:_,onDeposit:N,chainsInfo:X,isDeposit:o,isWeb3Wallet:k}},Ht=t=>{let{dataSource:i,queryParameter:o,onFilter:s,isLoading:a}=t,{dateRange:r,target:n}=o,c=Ot({chainsInfo:t.chainsInfo,isDeposit:t.isDeposit,isWeb3Wallet:t.isWeb3Wallet}),{t:l}=j(),m=d.useMemo(()=>[{label:l("common.web3Wallet"),value:"Web3Wallet"},{label:l("common.accountId"),value:"AccountId"}],[l]);return e.jsxs(e.Fragment,{children:[e.jsx(Q,{items:[{type:"select",name:"target",options:m,value:n},{type:"range",name:"dateRange",value:{from:r[0],to:r[1]}}],onFilter:h=>{s(h)}}),e.jsx(xe,{bordered:!0,loading:a,classNames:{root:"oui-h-[calc(100%_-_49px)]",scroll:"oui-min-h-[400px]"},columns:c,dataSource:i,pagination:t.pagination})]})},Zo=t=>{let{dataSource:i,queryParameter:o,onFilter:s,isLoading:a,pagination:r,onDeposit:n,chainsInfo:c,isDeposit:l,isWeb3Wallet:m}=t,{dateRange:h,target:f}=o,{t:g}=j(),x=d.useMemo(()=>[{label:g("common.web3Wallet"),value:"Web3Wallet"},{label:g("common.accountId"),value:"AccountId"}],[g]),b=()=>{var y;i.length<((r==null?void 0:r.count)||0)&&((y=r==null?void 0:r.onPageSizeChange)==null||y.call(r,(r==null?void 0:r.pageSize)+50))},w=y=>{let S=t.isWeb3Wallet?y.trans_status:y.status;return{[Y.NEW]:g("assetHistory.status.pending"),[Y.PENDING]:g("assetHistory.status.pending"),[Y.CONFIRM]:g("assetHistory.status.confirm"),[Y.PROCESSING]:g("assetHistory.status.processing"),[Y.COMPLETED]:g("assetHistory.status.completed"),[Y.FAILED]:g("assetHistory.status.failed")}[S]||bt(S==null?void 0:S.toLowerCase())},C=y=>{let S=l?`+${y.amount-(y.fee??0)}`:-(y.amount-(y.fee??0)),E=()=>{if(!y.tx_id)return;let k=c&&Array.isArray(c)?c.find(A=>parseInt(y.chain_id)===parseInt(A.chain_id)):void 0;if(k!=null&&k.explorer_base_url)return`${k.explorer_base_url}/tx/${y.tx_id}`},I=k=>{k.preventDefault(),k.stopPropagation(),F.success(g("common.copy.copied"))},X=l?"buy":"sell",Z=e.jsxs(p,{className:"oui-text-xs",children:[e.jsx(u,{color:X,children:S}),e.jsx(u,{className:"oui-ml-1",intensity:80,children:y.token}),m&&e.jsx(De,{color:X,className:"oui-ml-2",children:g(l?"common.deposit":"common.withdraw")})]}),v=e.jsx(u,{intensity:m?80:36,size:"xs",children:w(y)}),z=e.jsx(u.formatted,{rule:"date",intensity:36,size:"2xs",children:y.created_time}),_=y.tx_id?e.jsx("a",{href:E(),target:"_blank",rel:"noreferrer",children:e.jsx(u.formatted,{copyable:!!y.tx_id,className:"oui-underline oui-decoration-line-16 oui-decoration-dashed oui-underline-offset-4",rule:"txId",onCopy:I,intensity:36,size:"xs",children:y.tx_id})}):e.jsx(u,{intensity:54,children:"-"}),M=l?y.from_account_id:y.to_account_id,N=e.jsxs(p,{gapX:1,children:[e.jsx(u,{intensity:36,size:"xs",children:g(l?"transfer.internalTransfer.from":"transfer.internalTransfer.to")}),e.jsx(u.formatted,{rule:"address",copyable:!!M,onCopy:I,intensity:80,size:"xs",children:M})]});return e.jsxs(p,{p:2,direction:"column",gapY:1,intensity:900,r:"xl",className:"oui-font-semibold",children:[e.jsx(p,{justify:"between",width:"100%",height:"18px",children:m?e.jsxs(e.Fragment,{children:[Z,v]}):e.jsxs(e.Fragment,{children:[N,Z]})}),e.jsxs(p,{justify:"between",width:"100%",height:"18px",children:[z,m?_:v]})]})};return e.jsxs(e.Fragment,{children:[e.jsx(Q,{items:[{type:"picker",name:"target",options:x,value:f,size:"md"},{type:"range",name:"dateRange",value:{from:h[0],to:h[1]}}],onFilter:y=>{s(y)},className:"oui-sticky oui-top-[44px] oui-z-10 oui-border-none oui-bg-base-10 oui-px-3 oui-py-2"}),e.jsx(qe,{dataSource:i,renderItem:C,contentClassName:"!oui-space-y-1",loadMore:b,isLoading:a,className:"oui-px-1",emptyView:e.jsxs(p,{direction:"column",height:"100%",itemAlign:"center",justify:"center",mt:3,children:[e.jsx(Mi,{}),(i==null?void 0:i.length)==0&&e.jsxs(p,{direction:"row",itemAlign:"center",justify:"center",onClick:n,className:"oui-mt-2 oui-h-4 oui-w-full oui-text-secondary",children:[e.jsx(u,{color:"primary",size:"2xs",children:g("common.deposit")}),e.jsx(Nt,{className:"oui-ml-0.5 oui-size-4 oui-text-primary oui-opacity-100",color:"primary",size:16,opacity:100})]})]})})]})},Ne=t=>{let i=Wt({side:t.side}),{isMobile:o}=ee();return o?e.jsx(Zo,{...i}):e.jsx(Ht,{...i})},Xo=()=>{let{t}=j();return d.useMemo(()=>[{title:t("common.token"),dataIndex:"token",width:80,render:(i,o)=>e.jsxs(p,{gapX:2,children:[e.jsx(J,{name:i,size:"xs"}),e.jsx("span",{children:i})]})},{title:t("common.time"),dataIndex:"updated_time",width:120,rule:"date"},{title:t("common.status"),dataIndex:"status",width:120,formatter(i,o,s){switch(i){case"CREATED":case"SPLIT":return t("assetHistory.status.processing");case"COMPLETED":default:return t("assetHistory.status.completed")}}},{title:t("common.type"),dataIndex:"type",width:80,formatter:i=>{switch(i){case"REFERRER_REBATE":return t("portfolio.overview.distribution.type.referralCommission");case"REFEREE_REBATE":return t("portfolio.overview.distribution.type.refereeRebate");case"BROKER_FEE":return t("portfolio.overview.distribution.type.brokerFee");default:return"-"}}},{title:t("common.amount"),dataIndex:"amount",width:80}],[t])},Vt=t=>{let{dataSource:i,queryParameter:o,onFilter:s,isLoading:a,isValidating:r}=t,n=Xo(),{type:c,dateRange:l}=o,{t:m}=j(),h=d.useMemo(()=>[{label:m("common.all"),value:"All"},{label:m("portfolio.overview.distribution.type.referralCommission"),value:"REFERRER_REBATE"},{label:m("portfolio.overview.distribution.type.refereeRebate"),value:"REFEREE_REBATE"},{label:m("portfolio.overview.distribution.type.brokerFee"),value:"BROKER_FEE"}],[m]);return e.jsxs(e.Fragment,{children:[e.jsx(Q,{items:[{type:"select",name:"type",options:h,value:c},{type:"range",name:"dateRange",value:{from:l[0],to:l[1]}}],onFilter:f=>{s(f)}}),e.jsx(xe,{bordered:!0,columns:n,dataSource:i,loading:a,className:"oui-font-semibold",classNames:{root:"oui-h-[calc(100%_-_49px)]"},pagination:t.pagination})]})},$t=t=>{let{dataSource:i,queryParameter:o,onFilter:s,isLoading:a,pagination:r}=t,{type:n,dateRange:c}=o,{t:l}=j(),m=d.useMemo(()=>[{label:l("common.all"),value:"All"},{label:l("portfolio.overview.distribution.type.referralCommission"),value:"REFERRER_REBATE"},{label:l("portfolio.overview.distribution.type.refereeRebate"),value:"REFEREE_REBATE"},{label:l("portfolio.overview.distribution.type.brokerFee"),value:"BROKER_FEE"}],[l]),h=b=>{switch(b){case"CREATED":case"SPLIT":return l("assetHistory.status.processing");case"COMPLETED":default:return l("assetHistory.status.completed")}},f=b=>{switch(b){case"REFERRER_REBATE":return l("portfolio.overview.distribution.type.referralCommission");case"REFEREE_REBATE":return l("portfolio.overview.distribution.type.refereeRebate");case"BROKER_FEE":return l("portfolio.overview.distribution.type.brokerFee");default:return"-"}},g=b=>e.jsxs(p,{p:2,direction:"column",gapY:2,className:"oui-rounded-xl oui-bg-base-9 oui-font-semibold",children:[e.jsxs(p,{direction:"row",justify:"between",width:"100%",height:"20px",children:[e.jsx(u.formatted,{rule:"date",className:"oui-text-2xs oui-text-base-contrast-36",children:b.created_time}),e.jsx(u,{className:"oui-text-sm oui-text-base-contrast-80",children:h(b.status)})]}),e.jsx("div",{className:"oui-h-px oui-w-full oui-bg-base-6"}),e.jsxs(p,{direction:"row",justify:"between",width:"100%",children:[e.jsxs(p,{direction:"column",children:[e.jsx(u,{className:"oui-text-2xs oui-text-base-contrast-36",children:l("common.token")}),e.jsxs(p,{gapX:2,children:[e.jsx(J,{name:b.token,size:"xs"}),e.jsx("span",{className:"oui-text-xs oui-text-base-contrast-80",children:b.token})]})]}),e.jsxs(p,{direction:"column",children:[e.jsx(u,{className:"oui-text-2xs oui-text-base-contrast-36",children:l("common.type")}),e.jsx(u,{className:"oui-text-xs oui-text-base-contrast-80",children:f(b.type)})]}),e.jsxs(p,{direction:"column",children:[e.jsx(u,{className:"oui-text-2xs oui-text-base-contrast-36",children:l("common.amount")}),e.jsx(u,{className:"oui-text-xs oui-text-base-contrast-80",children:b.amount})]})]})]}),x=()=>{i.length<((r==null?void 0:r.count)||0)&&(r!=null&&r.onPageSizeChange)&&r.onPageSizeChange((r==null?void 0:r.pageSize)+50)};return e.jsxs(e.Fragment,{children:[e.jsx(Q,{items:[{type:"picker",name:"type",options:m,value:n,size:"md"},{type:"range",name:"dateRange",value:{from:c[0],to:c[1]}}],onFilter:b=>{s(b)},className:"oui-px-3 oui-py-2 oui-sticky oui-top-[44px] oui-z-10 oui-bg-base-10"}),e.jsx(qe,{dataSource:i,renderItem:g,contentClassName:"oui-space-y-1",loadMore:x,isLoading:a,className:"oui-px-1"})]})},Yo=()=>{let[t]=d.useState(()=>{let w=new Date;return new Date(fe(w),ge(w),he(w),0,0,0)}),[i,o]=d.useState([ke(90,t),t]),[s,a]=d.useState("All"),{page:r,pageSize:n,setPage:c,parsePagination:l}=me(),[m,{isLoading:h,meta:f,isValidating:g}]=Ri({dataRange:[i[0].getTime(),Se(i[1],{hours:23,minutes:59,seconds:59,milliseconds:0}).getTime()],type:s,pageSize:n,page:r}),x=w=>{w.name==="type"&&(a(w.value),c(1)),w.name==="dateRange"&&(o(ze(w.value)),c(1))},b=d.useMemo(()=>l(f),[l,f]);return{dataSource:m,isLoading:h,isValidating:g,queryParameter:{type:s,dateRange:i},onFilter:x,pagination:b}},tt=()=>{let t=Yo(),{isMobile:i}=ee();return i?e.jsx($t,{...t}):e.jsx(Vt,{...t})},Ut=()=>{let{t}=j();return d.useMemo(()=>[{title:t("common.symbol"),dataIndex:"symbol",width:80,rule:"symbol",textProps:{showIcon:!0}},{title:t("common.time"),dataIndex:"created_time",width:120,rule:"date"},{title:`${t("funding.fundingRate")} / ${t("funding.annualRate")}`,dataIndex:"funding_rate",width:80,render:(i,o)=>e.jsxs(p,{gap:1,children:[e.jsx(u.numeral,{rule:"percentages",dp:6,children:o.funding_rate}),e.jsx("span",{children:"/"}),e.jsx(u.numeral,{rule:"percentages",dp:6,children:o.annual_rate})]})},{title:t("funding.paymentType"),dataIndex:"payment_type",width:80,render:i=>{switch(i){case"Pay":case"Paid":return t("funding.paymentType.paid");case"Receive":case"Received":return t("funding.paymentType.received");default:return i}}},{title:`${t("funding.fundingFee")} (USDC)`,dataIndex:"funding_fee",width:80,rule:"price",formatter(i,o,s){return Number(i)*-1},numeralProps:{coloring:!0,showIdentifier:!0,ignoreDP:!0}}],[t])},Qo=t=>{let{dataSource:i,queryParameter:o,onFilter:s,isLoading:a}=t,r=Ut(),n=_t(),{symbol:c,dateRange:l}=o,{t:m}=j(),h=d.useMemo(()=>[{label:m("common.all"),value:"All"},...Object.keys(n).map(f=>({label:f.split("_")[1],value:f}))],[m,n]);return e.jsxs(e.Fragment,{children:[e.jsx(Q,{items:[{type:"select",name:"symbol",isCombine:!0,options:h,value:c,valueFormatter:f=>{var g;return((g=h.find(x=>x.value===f))==null?void 0:g.label)||f}},{type:"range",name:"dateRange",value:{from:l[0],to:l[1]}}],onFilter:f=>{s(f)}}),e.jsx(xe,{bordered:!0,columns:r,dataSource:i,loading:a,generatedRowKey:f=>`${f.updated_time}`,classNames:{root:"oui-h-[calc(100%_-_49px)]"},pagination:t.pagination})]})},Go=t=>{let{dataSource:i,queryParameter:o,onFilter:s,isLoading:a,pagination:r}=t,n=_t(),{symbol:c,dateRange:l}=o,{t:m}=j(),h=x=>{switch(x){case"Pay":case"Paid":return m("funding.paymentType.paid");case"Receive":case"Received":return m("funding.paymentType.received");default:return x}},f=()=>{i&&i.length<((r==null?void 0:r.count)||0)&&(r!=null&&r.onPageSizeChange)&&r.onPageSizeChange((r==null?void 0:r.pageSize)+50)},g=x=>e.jsxs(p,{p:2,direction:"column",gapY:2,className:"oui-rounded-xl oui-bg-base-9 oui-font-semibold",children:[e.jsxs(p,{direction:"row",justify:"between",width:"100%",height:"20px",children:[e.jsx(u.formatted,{rule:"symbol",className:"oui-text-base-contrast oui-mr-1 oui-text-sm",children:x.symbol}),e.jsx(De,{color:"neutral",size:"xs",children:h(x.payment_type)}),e.jsx(u.formatted,{rule:"date",className:"oui-text-base-contrast-36 oui-text-2xs oui-ml-auto",children:x.created_time})]}),e.jsx("div",{className:"oui-w-full oui-h-[1px] oui-bg-base-6"}),e.jsxs(p,{direction:"row",justify:"between",width:"100%",children:[e.jsxs(p,{direction:"column",children:[e.jsx(u,{className:"oui-text-base-contrast-36 oui-text-2xs",children:m("funding.fundingRate")}),e.jsx(u.numeral,{rule:"percentages",dp:6,className:"oui-text-base-contrast-80 oui-text-xs",children:x.funding_rate})]}),e.jsxs(p,{direction:"column",children:[e.jsx(u,{className:"oui-text-base-contrast-36 oui-text-2xs",children:m("funding.annualRate")}),e.jsx(u.numeral,{rule:"percentages",dp:6,className:"oui-text-base-contrast-80 oui-text-xs",children:x.annual_rate})]}),e.jsxs(p,{direction:"column",children:[e.jsxs(u,{className:"oui-text-base-contrast-36 oui-text-2xs",children:[m("funding.fundingFee")," ",e.jsx(u,{className:"oui-text-base-contrast-20",children:"(USDC)"})]}),e.jsx(u.numeral,{dp:6,ignoreDP:!0,coloring:!0,showIdentifier:!0,className:"oui-text-xs oui-self-end",children:Number(x.funding_fee)*-1})]})]})]});return e.jsxs(e.Fragment,{children:[e.jsx(Q,{items:[{type:"select",name:"symbol",isCombine:!0,options:[{label:"All",value:"All"},...Object.keys(n).map(x=>({label:x.split("_")[1],value:x}))],value:c,valueFormatter:x=>x==="All"?"All":x.split("_")[1]},{type:"range",name:"dateRange",value:{from:l[0],to:l[1]}}],onFilter:x=>{s(x)},className:"oui-px-3 oui-py-2 oui-sticky oui-top-[44px] oui-z-10 oui-bg-base-10"}),e.jsx(qe,{dataSource:i,renderItem:g,contentClassName:"!oui-space-y-1",loadMore:f,isLoading:a,className:"oui-px-1"})]})},Bt=()=>{let[t]=d.useState(()=>{let w=new Date;return new Date(fe(w),ge(w),he(w),0,0,0)}),[i,o]=d.useState([ke(90,t),t]),[s,a]=d.useState("All"),{page:r,pageSize:n,setPage:c,parsePagination:l}=me(),[m,{isLoading:h,meta:f,isValidating:g}]=Ii({dataRange:[i[0].getTime(),Se(i[1],{hours:23,minutes:59,seconds:59,milliseconds:0}).getTime()],symbol:s,page:r,pageSize:n},{keepPreviousData:!0}),x=w=>{w.name==="symbol"&&(a(w.value),c(1)),w.name==="dateRange"&&(o(ze(w.value)),c(1))},b=d.useMemo(()=>l(f),[l,f]);return{dataSource:m,isLoading:h,isValidating:g,queryParameter:{symbol:s,dateRange:i},onFilter:x,pagination:b}},it=()=>{let t=Bt(),{isMobile:i}=ee();return i?e.jsx(Go,{...t}):e.jsx(Qo,{...t})},Jo=t=>{let{active:i="deposit",onTabChange:o}=t,{t:s}=j();return e.jsx(ae,{children:e.jsxs(Fe,{value:i,onValueChange:o,variant:"contained",size:"xl",children:[e.jsx($,{title:s("common.deposits"),icon:e.jsx(Ye,{}),value:"deposit",children:e.jsx(Ne,{side:we.DEPOSIT})}),e.jsx($,{title:s("common.withdrawals"),icon:e.jsx(Xe,{}),value:"withdraw",children:e.jsx(Ne,{side:we.WITHDRAW})}),e.jsx($,{title:s("common.funding"),icon:e.jsx(Ti,{}),value:"funding",children:e.jsx(it,{})}),e.jsx($,{title:s("portfolio.overview.distribution"),icon:e.jsx(Ei,{}),value:"distribution",children:e.jsx(tt,{})}),e.jsx($,{title:s("portfolio.overview.transferHistory"),icon:e.jsx(Di,{}),value:"transfer",children:e.jsx(qo,{})})]})})},mt={token:"USDC",holding:0,frozen:0},ot=()=>{let{t}=j(),{state:i,isMainAccount:o}=T(),{holding:s=[]}=pe(),a=i.subAccounts??[];return d.useMemo(()=>zt(a,r=>{for(let n of r)n.account_id=n.id,Array.isArray(n.holding)&&n.holding.length?n.children=n.holding.map(c=>({...c,account_id:n.id})):n.children=[{...mt,account_id:n.id}],Reflect.deleteProperty(n,"holding");o&&r.unshift({account_id:i.mainAccountId,description:t("common.mainAccount"),children:Array.isArray(s)&&s.length?s.map(n=>({...n,account_id:i.mainAccountId})):[{...mt,account_id:i.mainAccountId}]})}),[s,a,o,i.mainAccountId,t])},ea=t=>{let{totalValue:i,visible:o,onToggleVisibility:s}=t,{t:a}=j(),r=o?Be:ft;return e.jsxs(p,{direction:"column",gap:1,className:"oui-text-2xs",itemAlign:"start",children:[e.jsxs(p,{gap:1,justify:"start",itemAlign:"center",children:[e.jsx(u,{size:"2xs",color:"neutral",weight:"semibold",children:a("common.totalValue")}),e.jsx("button",{onClick:s,children:e.jsx(r,{size:18,className:K("oui-text-base-contrast-54")})})]}),e.jsxs(p,{justify:"start",itemAlign:"end",gap:1,children:[e.jsx(u.numeral,{visible:o,weight:"bold",size:"2xl",className:gt({color:"brand"}),as:"div",padding:!1,dp:2,children:i??"--"}),e.jsx(u,{as:"div",weight:"bold",children:"USDC"})]})]})},ta=t=>{let{t:i}=j(),{isMainAccount:o,onWithdraw:s,onDeposit:a}=t,{wrongNetwork:r,disabledConnect:n}=te();if(!o)return null;let c=r||n;return e.jsxs(p,{className:"oui-text-2xs oui-text-base-contrast-54",itemAlign:"center",gap:3,children:[e.jsxs(q,{fullWidth:!0,disabled:c,color:"secondary",size:"md",onClick:s,"data-testid":"oui-testid-assetView-withdraw-button",children:[e.jsx(dt,{color:"white",opacity:c?.4:1,className:"oui-rotate-180"}),e.jsx(u,{children:i("common.withdraw")})]}),e.jsxs(q,{disabled:c,"data-testid":"oui-testid-assetView-deposit-button",fullWidth:!0,size:"md",onClick:a,children:[e.jsx(dt,{color:"white",opacity:c?.4:1,className:"oui-rotate-0"}),e.jsx(u,{children:i("common.deposit")})]})]})},ia=t=>{let{state:i,isMainAccount:o,selectedAccount:s,selectedAsset:a,columns:r,dataSource:n,onFilter:c,assetsOptions:l}=t,{t:m}=j(),h={label:m("common.allAccount"),value:"All accounts"},f={label:m("common.mainAccount"),value:"Main accounts"},g={label:m("common.allAssets","All assets"),value:"all"},x=d.useMemo(()=>i.subAccounts??[],[i.subAccounts]),b=d.useMemo(()=>Array.isArray(x)&&x.length?[h,f,...x.map(C=>({value:C.id,label:(C==null?void 0:C.description)||ue(C==null?void 0:C.id)}))]:[h,f],[h,f,x]),w=d.useMemo(()=>[g,...l],[g,l]);return e.jsx(ae,{className:"oui-bg-transparent oui-p-0",classNames:{content:"!oui-pt-0"},children:e.jsxs(Fe,{defaultValue:"assets",variant:"contained",classNames:{tabsList:""},size:"lg",children:[e.jsxs($,{value:"assets",className:"",title:m("common.assets"),children:[e.jsxs(p,{className:"oui-rounded-xl oui-bg-base-9 oui-p-6",direction:"row",itemAlign:"center",justify:"between",my:4,children:[e.jsx(ea,{...ut(["totalValue","visible","onToggleVisibility"],t)}),e.jsx(ta,{...ut(["isMainAccount","onDeposit","onWithdraw"],t)})]}),o&&e.jsx(Q,{className:"oui-border-none oui-py-0",onFilter:c,items:[{type:"select",name:"account",value:s,options:b},{type:"select",name:"asset",value:a,options:w}]}),n.map((C,y)=>e.jsxs(p,{className:"oui-rounded-xl oui-bg-base-9 oui-p-6",direction:"column",itemAlign:"start",justify:"between",my:4,children:[e.jsx(u,{className:"oui-mb-4",intensity:98,weight:"semibold",size:"lg",children:(C==null?void 0:C.description)||ue((C==null?void 0:C.id)??"")}),e.jsx(xe,{bordered:!0,className:"oui-font-semibold",classNames:{root:"oui-bg-transparent",scroll:"oui-min-h-0"},columns:r,dataSource:C.children})]},`item-${y}`))]}),e.jsx($,{className:"oui-rounded-xl oui-bg-base-9 oui-px-6",value:"convertHistory",title:m("portfolio.overview.tab.convert.history"),children:e.jsx(Xt,{})})]})})},oa=t=>{let{state:i,isMainAccount:o}=T(),[s,a]=P.useState("All accounts"),r=d.useMemo(()=>t.filter(c=>o?!s||s==="All accounts"?!0:s==="Main accounts"?c.account_id===i.mainAccountId:c.account_id===s:c.account_id===i.accountId),[t,s,o,i]),n=P.useCallback(c=>{let{name:l,value:m}=c;l==="account"&&a(m)},[]);return{selectedAccount:s,filteredData:r,onAccountFilter:n,setSelectedAccount:a}},aa=t=>{let{state:i,isMainAccount:o}=T(),[s,a]=P.useState("All accounts"),[r,n]=P.useState("all"),c=d.useMemo(()=>{let m=t;return o?s&&s!=="All accounts"&&(s==="Main accounts"?m=t.filter(h=>h.account_id===i.mainAccountId):m=t.filter(h=>h.account_id===s)):m=t.filter(h=>h.account_id===i.accountId),r&&r!=="all"&&(m=m.map(h=>{if(h.children){let f=h.children.filter(g=>g.token===r);return f.length>0?{...h,children:f}:null}return h}).filter(Boolean)),m},[t,s,r,o,i]),l=P.useCallback(m=>{let{name:h,value:f}=m;h==="account"?a(f):h==="asset"&&n(f)},[]);return{selectedAccount:s,selectedAsset:r,filteredData:c,onFilter:l,setSelectedAccount:a,setSelectedAsset:n}},sa=()=>{let{isMainAccount:t,state:i}=T(),{holding:o=[]}=pe(),{data:s}=Je(),{data:a}=yt("/v1/public/chain_info",{revalidateOnFocus:!1}),{page:r,pageSize:n,setPage:c,parsePagination:l}=me({page:1,pageSize:20}),m=ot(),h=Pe(),{selectedAccount:f,onAccountFilter:g}=oa(m),[x]=d.useState(()=>{let N=new Date;return new Date(fe(N),ge(N),he(N),0,0,0)}),[b,w]=d.useState([ke(90,x),x]),[C,y]=d.useState("all"),[S,E]=d.useState("all"),I=d.useMemo(()=>{let N=(h==null?void 0:h.map(k=>({value:k.token,label:k.token})))||[];return[{label:"All assets",value:"all"},...N]},[h]),X=P.useCallback(N=>{let{name:k,value:A}=N;k==="account"?g(N):k==="status"?(y(A),c(1)):k==="converted_asset"?(E(A),c(1)):(k==="time"||k==="dateRange")&&(w(ze(A)),c(1))},[g,c]),Z=P.useMemo(()=>{let N=new URLSearchParams;return N.set("page",r.toString()),N.set("size",n.toString()),b[0]&&N.set("start_t",b[0].getTime().toString()),b[1]&&N.set("end_t",Se(b[1],{hours:23,minutes:59,seconds:59,milliseconds:0}).getTime().toString()),C!=="all"&&N.set("status",C),S!=="all"&&N.set("converted_asset",S),`/v1/asset/convert_history?${N.toString()}`},[r,n,b,C,S]),{data:v,isLoading:z}=ao(Z,{accountId:t?i.mainAccountId:i.accountId,formatter:N=>N}),_=d.useMemo(()=>v!=null&&v.meta?l(v.meta):{page:r,pageSize:n,onPageChange:c,onPageSizeChange:N=>{}},[v==null?void 0:v.meta,l,r,n,c]),M=d.useMemo(()=>{let N=(v==null?void 0:v.rows)||[],k=N.length,A=N.reduce((ie,se)=>ie+se.received_qty,0),L=N.reduce((ie,se)=>ie+se.details.reduce((be,je)=>be+je.haircut,0),0);return{totalConversions:k,totalUSDCReceived:A,totalFees:L}},[v]);return{dataSource:(v==null?void 0:v.rows)||[],summary:M,pagination:_,selectedAccount:f,onFilter:X,dateRange:b,statusFilter:C,convertedAssetFilter:S,convertedAssetOptions:I,isMainAccount:t,isLoading:z,holding:o,indexPrices:s,chainsInfo:a}},qt=({convertedAssets:t})=>{let{t:i}=j(),o=d.useMemo(()=>Object.keys(t),[t]),s=d.useMemo(()=>e.jsxs(p,{direction:"column",gap:2,className:"oui-w-[275px] oui-font-semibold oui-text-base-contrast-80",children:[e.jsxs(p,{itemAlign:"center",justify:"between",className:"oui-w-full oui-text-2xs oui-text-base-contrast-36",children:[e.jsx("div",{children:i("common.assets")}),e.jsx("div",{children:i("common.qty")})]}),o.map(a=>e.jsxs(p,{itemAlign:"center",justify:"between",className:"oui-w-full",children:[e.jsxs(p,{itemAlign:"center",gap:1,children:[e.jsx(J,{size:"xs",name:a}),e.jsx(u.formatted,{children:a})]}),e.jsx("div",{children:e.jsx(u.formatted,{children:t[a]})})]},a))]}),[o]);return e.jsxs(p,{itemAlign:"center",gap:2,children:[e.jsx("div",{className:"oui-relative oui-flex",children:o.slice(0,3).map((a,r)=>e.jsx("div",{className:"oui-relative",style:{marginLeft:r>0?"-8px":"0",zIndex:o.length+r},children:e.jsx(J,{size:"xs",name:a})},a))}),e.jsx(Ze,{content:s,children:e.jsxs(u.formatted,{className:"oui-cursor-pointer oui-underline oui-decoration-line-16 oui-decoration-dashed oui-underline-offset-4",children:[o.slice(0,3).join(", ")," ",o.length>3&&`+${o.length-3}`]})})]})},ra=t=>{let{onDetailsClick:i}=t,{t:o}=j(),s=a=>{a.preventDefault(),a.stopPropagation(),F.success(o("common.copy.copied"))};return P.useMemo(()=>[{title:o("portfolio.overview.column.convert.convertedAsset"),dataIndex:"converted_asset",align:"left",width:200,maxWidth:200,render(a){return e.jsx(qt,{convertedAssets:a})}},{title:o("portfolio.overview.column.convert.usdcAmount"),dataIndex:"received_qty",align:"left",width:150,render(a,r){return e.jsx(u.numeral,{dp:6,padding:!1,children:a})}},{title:o("common.fee"),dataIndex:"details",align:"left",width:120,render(a){let r=a.reduce((n,c)=>n+c.haircut,0);return e.jsx(u.numeral,{dp:6,padding:!1,children:r})}},{title:o("common.type"),dataIndex:"type",align:"left",width:150,render(a){return e.jsx(u,{children:a.charAt(0).toUpperCase()+a.slice(1)})}},{title:o("portfolio.overview.column.convert.convertId"),dataIndex:"convert_id",align:"left",width:150,render(a){return e.jsx(u.formatted,{onCopy:s,copyable:!0,children:a})}},{title:o("common.time"),dataIndex:"created_time",align:"left",width:160,rule:"date"},{title:o("common.status"),dataIndex:"status",align:"left",width:150,render(a){return e.jsx(u,{children:a.charAt(0).toUpperCase()+a.slice(1)})}},{title:"",dataIndex:"updated_time",align:"center",width:80,render(a,r){return e.jsx(q,{size:"sm",variant:"text",className:"oui-text-primary",onClick:()=>i==null?void 0:i(r.convert_id),children:o("portfolio.overview.column.convert.details")})}}],[i])},na=t=>{let{t:i}=j(),o=s=>{s.preventDefault(),s.stopPropagation(),F.success(i("common.copy.copied"))};return P.useMemo(()=>[{title:i("portfolio.overview.column.convert.convertedAsset"),dataIndex:"converted_asset",align:"left",width:150,render(s){return e.jsxs(p,{itemAlign:"center",gap:2,children:[e.jsx(J,{name:s}),s]})}},{title:i("common.qty"),dataIndex:"converted_qty",align:"left",width:100,render(s,a){return e.jsx(u.numeral,{dp:6,padding:!1,children:s})}},{title:i("portfolio.overview.column.convert.usdcAmount"),dataIndex:"received_qty",align:"left",width:100,render(s,a){return e.jsx(u.numeral,{dp:6,padding:!1,children:s})}},{title:i("common.fee"),dataIndex:"haircut",align:"left",width:100,render(s){return e.jsx(u.numeral,{dp:6,padding:!1,children:s})}},{title:i("common.txId"),dataIndex:"tx_id",align:"left",width:150,render(s,a){var n,c;if(!s)return e.jsx(u,{intensity:54,children:"-"});let r=`${(c=(n=t.chainsInfo)==null?void 0:n.find(l=>a.chain_id===parseInt(l.chain_id)))==null?void 0:c.explorer_base_url}/tx/${s}`;return e.jsx("a",{href:r,target:"_blank",rel:"noreferrer",children:e.jsx(u.formatted,{onCopy:o,rule:"txId",copyable:!!s,className:"oui-cursor-pointer oui-underline oui-decoration-line-16 oui-decoration-dashed oui-underline-offset-4",children:s})})}},{title:i("transfer.network"),dataIndex:"chain_id",align:"left",width:150,render(s,a){var r;return e.jsx(u,{children:((r=t.chainsInfo.find(n=>n.chain_id==a.chain_id))==null?void 0:r.name)||"-"})}},{title:i("common.result"),dataIndex:"result",align:"left",width:100,render(s){return e.jsx(u,{children:(s==null?void 0:s.charAt(0).toUpperCase())+(s==null?void 0:s.slice(1))})}}],[])},Zt=[{label:"All status",value:"all"},{label:"Completed",value:"completed"},{label:"Pending",value:"pending"}],la=O.create(t=>{let{t:i}=j(),{visible:o,onOpenChange:s}=ht(),a=na({indexPrices:t.indexPrices,chainsInfo:t.chainsInfo});return e.jsx(Ae,{open:o,onOpenChange:s,title:i("portfolio.overview.convert.dialog.title.details"),size:"lg",closable:!0,classNames:{content:"oui-max-w-4xl"},children:e.jsx(Ue,{columns:a,dataSource:t.record.details,bordered:!0,className:"oui-w-full",classNames:{header:"oui-h-10",root:"oui-bg-base-8 oui-max-h-[60vh] oui-overflow-y-scroll"},onRow:()=>({className:"oui-h-[40px]"}),generatedRowKey:r=>r.transaction_id||Math.random().toString()})})}),ca=({convertState:t})=>{let i=ra({onDetailsClick:l=>{let m=t.dataSource.find(h=>h.convert_id===l);m&&O.show(la,{record:m,indexPrices:t.indexPrices,chainsInfo:t.chainsInfo})}}),{convertedAssetFilter:o,statusFilter:s,dateRange:a,onFilter:r,convertedAssetOptions:n}=t,c=d.useMemo(()=>e.jsx(Q,{className:"",onFilter:r,items:[{type:"select",name:"converted_asset",value:o,options:n},{type:"select",name:"status",value:s,options:Zt},{type:"range",name:"time",value:{from:a==null?void 0:a[0],to:a==null?void 0:a[1]}}]}),[o,s,a,r,n]);return e.jsxs(p,{direction:"column",mt:4,itemAlign:"center",className:"oui-w-full",children:[e.jsx(de,{className:"oui-w-full oui-border-b oui-border-line-4 oui-pt-6"}),e.jsx(p,{direction:"row",className:"oui-w-full",children:c}),e.jsx(Ue,{columns:i,dataSource:t.dataSource,loading:t.isLoading,bordered:!0,pagination:t.pagination,manualPagination:!0,className:"oui-mt-4 oui-w-full",classNames:{root:"oui-h-[calc(100vh_-_200px)]",header:"oui-h-12"},onRow:()=>({className:"oui-h-[48px] oui-cursor-pointer"}),generatedRowKey:l=>l.convert_id.toString()})]})},ua=({convertState:t})=>{let{t:i}=j(),{convertedAssetFilter:o,statusFilter:s,dateRange:a,onFilter:r,convertedAssetOptions:n}=t,c=d.useMemo(()=>e.jsx(Q,{onFilter:r,items:[{size:"md",type:"picker",name:"converted_asset",value:o,options:n,className:"oui-whitespace-nowrap"},{size:"md",type:"picker",name:"status",value:s,options:Zt,className:"oui-whitespace-nowrap"},{type:"range",name:"time",value:{from:a==null?void 0:a[0],to:a==null?void 0:a[1]}}]}),[o,s,a,r,n]);return e.jsxs("div",{className:"oui-flex oui-flex-col oui-gap-1 oui-px-3",children:[e.jsx(so,{className:"oui-pr-5",children:e.jsx(p,{direction:"row",children:c})}),t.dataSource.map(l=>e.jsx(da,{item:l,chainsInfo:t.chainsInfo},l.convert_id))]})},G=({label:t,value:i,rule:o,copyable:s=!1,className:a="",onClick:r})=>{let{t:n}=j(),c=l=>{l.preventDefault(),l.stopPropagation(),F.success(n("common.copy.copied"))};return e.jsxs("div",{className:`oui-text-2xs oui-font-semibold oui-text-base-contrast-80 [&_p]:oui-text-base-contrast-36 ${a}`,onClick:r,children:[e.jsx("p",{children:t}),e.jsx(u.formatted,{rule:o,copyable:s,onCopy:c,children:i||"-"})]})},da=t=>{var a,r,n,c;let{item:i}=t,{t:o}=j();if(!i)return null;let s=i.details.reduce((l,m)=>l+m.haircut,0);return e.jsxs("div",{className:"oui-flex oui-flex-col oui-gap-2 oui-rounded-xl oui-bg-base-9 oui-p-2",children:[e.jsxs("div",{className:"oui-flex oui-justify-between",children:[e.jsxs("div",{className:"oui-flex oui-items-center oui-text-xs oui-font-semibold oui-text-base-contrast-80",children:[e.jsx(qt,{convertedAssets:i.converted_asset}),e.jsx("div",{className:"oui-ml-2 oui-text-primary",onClick:()=>{O.show(ma,{item:i,chainsInfo:t.chainsInfo})},children:o("portfolio.overview.column.convert.details")})]}),e.jsx(u.formatted,{className:"oui-text-2xs oui-text-base-contrast-36",rule:"date",children:i.created_time})]}),e.jsxs("div",{className:"oui-grid oui-grid-cols-3 oui-gap-2",children:[e.jsx(G,{label:o("portfolio.overview.column.convert.usdcAmount"),value:i.received_qty}),e.jsx(G,{label:o("common.fee"),value:s}),e.jsx(G,{label:o("portfolio.overview.column.convert.convertId"),value:i.convert_id,copyable:!0}),e.jsx(G,{label:o("common.type"),value:((a=i.type)==null?void 0:a.charAt(0).toUpperCase())+((r=i.type)==null?void 0:r.slice(1))}),e.jsx(G,{label:o("common.status"),value:((n=i.status)==null?void 0:n.charAt(0).toUpperCase())+((c=i.status)==null?void 0:c.slice(1))})]})]})},ma=O.create(t=>{let{item:i,chainsInfo:o}=t,{t:s}=j(),{visible:a,onOpenChange:r}=ht();return e.jsx(_i,{title:s("portfolio.overview.convert.dialog.title.details"),open:a,onOpenChange:r,children:e.jsx("div",{className:"oui-flex oui-h-[300px] oui-flex-col oui-gap-3 oui-overflow-y-auto oui-rounded-lg oui-bg-base-7 oui-p-2",children:i.details.map((n,c)=>{var l;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"oui-flex oui-flex-col oui-gap-2",children:[e.jsxs("div",{className:"oui-flex oui-items-center oui-gap-1",children:[e.jsx(J,{name:n.converted_asset,size:"xs"}),e.jsx("div",{className:"oui-text-xs oui-text-base-contrast-80",children:n.converted_asset})]}),e.jsxs("div",{className:"oui-grid oui-grid-cols-3 oui-gap-2",children:[e.jsx(G,{label:s("common.qty"),value:n.converted_qty}),e.jsx(G,{label:s("portfolio.overview.column.convert.usdcAmount"),value:n.received_qty}),e.jsx(G,{label:"Fee",value:n.haircut}),e.jsx(G,{label:s("common.txId"),copyable:!!n.tx_id,rule:"txId",value:n.tx_id,onClick:()=>{if(n.tx_id){let m=o.find(h=>h.chain_id==n.chain_id);m!=null&&m.explorer_base_url&&window.open(`${m.explorer_base_url}/tx/${n.tx_id}`,"_blank")}}}),e.jsx(G,{label:s("transfer.network"),value:((l=o.find(m=>m.chain_id==n.chain_id))==null?void 0:l.name)||"-"}),e.jsx(G,{label:s("common.result"),value:n.result?n.result.charAt(0).toUpperCase()+n.result.slice(1):"-"})]})]}),c<i.details.length-1&&e.jsx(de,{})]})})})})}),Xt=()=>{let t=sa(),{isMobile:i}=ee();return i?e.jsx(ua,{convertState:t}):e.jsx(ca,{convertState:t})},pa=t=>{let{active:i="deposit",onTabChange:o}=t,{t:s}=j();return e.jsxs(Fe,{value:i,onValueChange:o,variant:"contained",size:"lg",classNames:{tabsList:"oui-px-3 oui-py-2",scrollIndicator:"oui-pr-3"},showScrollIndicator:!0,children:[e.jsx($,{title:s("common.deposits"),value:"deposit",children:e.jsx(Ne,{side:we.DEPOSIT})}),e.jsx($,{title:s("common.withdrawals"),value:"withdraw",children:e.jsx(Ne,{side:we.WITHDRAW})}),e.jsx($,{title:s("common.funding"),value:"funding",children:e.jsx(it,{})}),e.jsx($,{title:s("portfolio.overview.distribution"),value:"distribution",children:e.jsx(tt,{})}),e.jsx($,{title:s("portfolio.overview.tab.convert.history"),value:"convert",children:e.jsx(Xt,{})})]})},Le=()=>{let t=Vo(),{isMobile:i}=ee();return i?e.jsx(pa,{...t}):e.jsx(Jo,{...t})},xa=({type:t=nt.normal})=>{let i=Fi(t===nt.mm?lt.mmOrder:lt.order),[o]=Li(t),[s]=Oi(),{state:a}=T(),{data:r,mutate:n}=At("/v1/referral/info",{revalidateOnFocus:!0}),c=Wi(t),l=Hi("brokerId"),m=d.useMemo(()=>s==null?void 0:s[l],[l,s]),h=d.useRef(R.NotConnected);return d.useEffect(()=>{let f;return h.current!==a.status&&(h.current=a.status,f=setTimeout(()=>{n()},1e3)),()=>{f&&clearTimeout(f)}},[a.status]),{totalOrderClaimedReward:i,curEpochEstimate:o,epochList:c,brokerName:m,referralInfo:r}},ha=()=>{let{totalOrderClaimedReward:t,curEpochEstimate:i,epochList:o,brokerName:s,referralInfo:a}=d.useContext(at),{state:r}=T(),{wrongNetwork:n}=te(),c=r.status===R.EnableTrading||r.status===R.EnableTradingWithoutConnected;return{totalOrderClaimedReward:t,curEpochEstimate:i,epochList:o,brokerName:s,isSignIn:c,referralInfo:a,wrongNetwork:n}},Yt=(t=>(t.WEEK="7D",t.MONTH="30D",t.QUARTER="90D",t))(Yt||{}),ga=(t,i)=>{var Z;let[o]=d.useState(()=>{let v=new Date;return new Date(fe(v),ge(v),he(v),0,0,0)}),{isRealtime:s=!1}=i||{},a=Object.values(Yt),[r,n]=Ke(t,"7D"),{totalValue:c}=pe(),l=v=>{switch(v){case"30D":return Re(o,35);case"90D":return Re(o,95);default:return Re(o,10)}},m=d.useMemo(()=>{switch(r){case"7D":return 7;case"30D":return 30;case"90D":return 90;default:return 7}},[r]),[h,f]=d.useState(l(r)),g=d.useMemo(()=>Pi(o,1),[o]),[x]=Ki({startDate:h.toISOString().split("T")[0],endDate:g.toISOString().split("T")[0]},{ignoreAggregation:!0}),[b]=jt({startTime:Re(o,2).getTime(),endTime:g.getTime(),pageSize:50}),w=v=>{f(l(v)),n(v)},C=v=>{if(c==null)return null;let z=new oe(c).sub(v.lastItem.account_value);if(Array.isArray(v.assetHistory)&&v.assetHistory.length>0&&typeof v.lastItem.snapshot_time<"u"){let _=[];for(let M=0;M<v.assetHistory.length;M++){let N=v.assetHistory[M];N.created_time>v.lastItem.snapshot_time&&_.push(N)}for(let M=0;M<_.length;M++){let N=_[M];N.side==="DEPOSIT"?N.trans_status==="COMPLETED"&&(z=z.sub(N.amount)):N.side==="WITHDRAW"&&N.trans_status!=="FAILED"&&(z=z.add(N.amount))}}return z.toNumber()},y=(v,z)=>{let _=v[v.length-1],M=We(o,"yyyy-MM-dd");return{..._,date:M,perp_volume:0,account_value:z!==null?z:(_==null?void 0:_.account_value)??0,pnl:C({lastItem:_,assetHistory:b})??0}},S=(v,z)=>!Array.isArray(v)||v.length===0?v:(v[v.length-1].date,We(o,"yyyy-MM-dd"),v.concat([y(v,z)])),E=(v,z)=>{let _=z?S(v,c):v;return _.slice(Math.max(0,_.length-m))},I=d.useMemo(()=>c==null?[]:E(x,s),[x,c,b,s]),X=d.useMemo(()=>{var M;let v=ve,z=ve,_=ve;if(Array.isArray(I)&&I.length){I.forEach(L=>{z=z.add(L.pnl)});let N=I[0],k=x.findIndex(L=>L.date===N.date),A=(M=x[k-1])==null?void 0:M.account_value;typeof A>"u"||A===0?_=ve:_=z.div(A)}if(x.length>0)for(let N=0;N<m;N++){let k=x[x.length-1-N];k&&(v=v.add(k.perp_volume??0))}return{vol:v.toNumber(),pnl:z.toNumber(),roi:_.toNumber()}},[I,x,m]);return{periodTypes:a,period:r,onPeriodChange:w,data:I,aggregateValue:X,createFakeData:(v,z)=>Array.from({length:2},(_,M)=>({date:We(M===0?h:new Date,"yyyy-MM-dd"),...M===0?v:z})),volumeUpdateDate:((Z=x==null?void 0:x[x.length-1])==null?void 0:Z.date)??""}},at=d.createContext({}),fa="portfolio_performance_period",Qt=()=>d.useContext(at),Gt=t=>{let i=ga(fa,{isRealtime:!0}),o=xa({type:t.type});return e.jsx(at.Provider,{value:{...i,type:t.type,...o},children:t.children})},Jt=()=>{let t=Qt(),{wrongNetwork:i,disabledConnect:o}=te(),{state:s}=T(),a=Ce(t.data,{accountStatus:s.status===R.EnableTradingWithoutConnected?R.EnableTradingWithoutConnected:R.EnableTrading,fallbackData:t.createFakeData({account_value:0},{account_value:500})}),r=d.useMemo(()=>(a==null?void 0:a.length)??!1?a:t.createFakeData({account_value:0},{account_value:500}),[a]),n=i||o||!t.data.length;return{...t,data:r,invisible:n}},ei=t=>{let{t:i}=j(),o=d.useMemo(()=>({"7D":i("common.select.7d"),"30D":i("common.select.30d"),"90D":i("common.select.90d")}),[i]);return e.jsxs(p,{justify:"between",children:[e.jsx(wt,{children:t.title}),e.jsx("div",{className:"oui-min-w-14",children:e.jsx(Vi.options,{size:"xs",value:t.period,onValueChange:t.onPeriodChange,options:t.periodTypes.map(s=>({value:s,label:o[s]}))})})]})},ti=t=>{let{onPeriodChange:i,periodTypes:o,period:s}=t,{t:a}=j();return e.jsx(ae,{title:e.jsx(ei,{onPeriodChange:i,periodTypes:o,period:s,title:a("common.assets")}),id:"portfolio-overview-assets-chart",classNames:{content:"oui-h-[168px] oui-pb-0"},children:e.jsx(Ao,{data:t.data,invisible:t.invisible})})},ii=()=>{let t=Jt();return e.jsx(ti,{...t})},oi=t=>{var h;let{periodTypes:i,period:o,onPeriodChange:s,aggregateValue:a,invisible:r,visible:n,volumeUpdateDate:c}=t,{t:l}=j(),m=d.useMemo(()=>({"7D":l("common.select.7d"),"30D":l("common.select.30d"),"90D":l("common.select.90d")}),[l]);return e.jsxs(ae,{title:e.jsx(ei,{onPeriodChange:s,periodTypes:i,period:o,title:l("portfolio.overview.performance")}),id:"portfolio-overview-performance",children:[e.jsxs(le,{cols:3,gap:4,children:[e.jsx(W,{gradient:"neutral",r:"md",px:4,py:2,angle:184,border:!0,borderColor:6,children:e.jsx(B,{label:l("portfolio.overview.performance.roi",{period:m[o]}),valueProps:{rule:"percentages",coloring:!0,visible:n},children:r?"--":a.roi})}),e.jsx(W,{gradient:"neutral",r:"md",px:4,py:2,angle:184,border:!0,borderColor:6,children:e.jsx(B,{label:l("portfolio.overview.performance.pnl",{period:m[o]}),valueProps:{coloring:!0,showIdentifier:!0,visible:n},children:r?"--":a.pnl})}),e.jsx(W,{gradient:"neutral",r:"md",px:4,py:2,angle:184,border:!0,borderColor:6,children:e.jsx(B,{classNames:{label:"oui-w-full"},label:e.jsxs(p,{justify:"between",children:[e.jsx("span",{children:l("portfolio.overview.performance.volume",{period:m[o]})}),e.jsx("span",{children:c})]}),children:r?"--":a.vol})})]}),e.jsxs(le,{cols:2,gap:4,children:[e.jsx(ba,{data:t.data??[],invisible:t.invisible}),e.jsx(ja,{data:t.data??[],invisible:t.invisible||(((h=t.data)==null?void 0:h.length)??0)<=2})]})]})},ba=t=>{var o;let{t:i}=j();return e.jsxs(W,{mt:4,height:"188px",children:[e.jsx(u,{as:"div",size:"sm",className:"oui-mb-3",children:i("portfolio.overview.performance.dailyPnl")}),e.jsx(W,{r:"md",className:"oui-border oui-border-line-4 oui-h-[188px]",children:e.jsx(ko,{data:t.data,invisible:t.invisible||(((o=t.data)==null?void 0:o.length)??0)<=2})})]})},ja=t=>{var o;let{t:i}=j();return e.jsxs(W,{mt:4,children:[e.jsx(u,{as:"div",size:"sm",className:"oui-mb-3",children:i("portfolio.overview.performance.cumulativePnl")}),e.jsx(W,{r:"md",className:"oui-border oui-border-line-4 oui-h-[188px]",children:e.jsx(Io,{data:t.data,invisible:t.invisible||(((o=t.data)==null?void 0:o.length)??0)<=2})})]})},ai=()=>{let t=Qt(),[i]=Ke("orderly_assets_visible",!0),{wrongNetwork:o,disabledConnect:s}=te(),{state:a}=T(),r=Ce(t.data,{accountStatus:a.status===R.EnableTradingWithoutConnected?R.EnableTradingWithoutConnected:R.EnableTrading,fallbackData:t.createFakeData({account_value:0,pnl:0},{account_value:500,pnl:500})}),n=d.useMemo(()=>(r==null?void 0:r.length)??!1?r:t.createFakeData({account_value:0,pnl:0},{account_value:500,pnl:500}),[r]),c=o||s||a.status<R.EnableTrading&&a.status!==R.EnableTradingWithoutConnected;return{...t,data:n,invisible:c,visible:i}},si=()=>{let t=ai();return e.jsx(oi,{...t})},va=()=>{let{state:t}=T(),{wrongNetwork:i,disabledConnect:o,connectWallet:s}=te(),{t:a}=j(),r={wrongNetwork:{description:a("connector.wrongNetwork.tooltip"),rootClass:"oui-bg-[linear-gradient(15deg,#D25F00_0%,transparent_30%)]"},connectWallet:{description:a("connector.trade.connectWallet.tooltip"),rootClass:"oui-bg-[linear-gradient(15deg,#27FDFE_0%,transparent_30%)]"},notSignedIn:{description:a("connector.trade.createAccount.tooltip"),rootClass:"oui-bg-[linear-gradient(15deg,#335FFC_0%,transparent_30%)]"},disabledTrading:{description:a("connector.trade.enableTrading.tooltip"),rootClass:"oui-bg-[linear-gradient(15deg,#335FFC_0%,transparent_30%)]"},default:{description:"",rootClass:"",arrowIconClass:"",textClass:""}};return d.useMemo(()=>{if(o)return r.connectWallet;if(i)return r.wrongNetwork;switch(t.status){case R.NotConnected:return r.connectWallet;case R.NotSignedIn:return r.notSignedIn;case R.DisabledTrading:return r.disabledTrading;default:return r.default}},[t.status,i])};function ya({children:t}){let[i]=no("mainnet",{pick:"network_infos"}),{t:o}=j();return e.jsx("button",{onClick:()=>{O.dialog({title:o("connector.privy.supportedEvmChain"),size:"xs",content:e.jsx("div",{children:e.jsx("div",{className:"oui-p-1 oui-grid oui-grid-cols-2 oui-gap-x-2 oui-gap-y-3 oui-text-2xs oui-text-base-contrast-54",children:i.map((s,a)=>e.jsxs("div",{className:"oui-flex oui-items-center oui-justify-start oui-gap-1",children:[e.jsx(lo,{chainId:s.chain_id,size:"2xs"}),e.jsx("div",{children:s.name})]},a))})})})},children:t})}var wa=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor",...t,children:[e.jsx("path",{d:"M8.00521 6.66797C8.74161 6.66797 9.33854 7.26464 9.33854 8.0013C9.33854 8.73797 8.74161 9.33464 8.00521 9.33464C7.26881 9.33464 6.67188 8.73797 6.67188 8.0013C6.67188 7.26464 7.26881 6.66797 8.00521 6.66797Z"}),e.jsx("path",{d:"M3.33333 6.66797C4.06973 6.66797 4.66667 7.26464 4.66667 8.0013C4.66667 8.73797 4.06973 9.33464 3.33333 9.33464C2.59693 9.33464 2 8.73797 2 8.0013C2 7.26464 2.59693 6.66797 3.33333 6.66797Z"}),e.jsx("path",{d:"M12.6666 6.66797C13.403 6.66797 14 7.26464 14 8.0013C14 8.73797 13.403 9.33464 12.6666 9.33464C11.9302 9.33464 11.3333 8.73797 11.3333 8.0013C11.3333 7.26464 11.9302 6.66797 12.6666 6.66797Z"})]}),Ca=()=>e.jsxs("div",{className:"oui-relative oui-flex oui-items-center oui-justify-center",children:[e.jsx("div",{className:"oui-flex oui-h-[18px] oui-items-center oui-justify-center ",children:e.jsx("img",{src:"https://oss.orderly.network/static/sdk/portfolio/chains.png",className:"oui-relative oui-z-0 oui-h-[18px] oui-w-[49px]"})}),e.jsxs("div",{className:"oui-relative oui-left-[-9px] oui-flex oui-items-center oui-justify-center oui-gap-1",children:[e.jsx("div",{className:"oui-flex oui-size-[18px] oui-items-center oui-justify-center oui-rounded-full oui-bg-[#282e3a]",children:e.jsx(ya,{children:e.jsx(wa,{className:"oui-relative oui-z-10 oui-size-3 oui-text-base-contrast-54 hover:oui-text-base-contrast",style:{zIndex:1}})})}),e.jsx("div",{className:"oui-text-2xs oui-font-semibold oui-text-base-contrast",children:"Evm"})]})]}),Na=()=>{let{state:t}=T(),{namespace:i}=Ct(),{t:o}=j(),s=()=>{navigator.clipboard.writeText(t.address??""),F.success(o("common.copy.copied"))},a=d.useMemo(()=>{var l;return i||(t.status===R.EnableTradingWithoutConnected?(l=Aa())==null?void 0:l.chainNamespace:null)},[i,t.status]),r=d.useMemo(()=>{if(t.address)return e.jsxs(p,{className:"oui-text-base oui-text-base-contrast",gapX:2,children:[ue(t.address??""),e.jsx("button",{className:"oui-cursor-pointer",onClick:()=>{s()},children:e.jsx(Ge,{size:18,className:"oui-text-base-contrast-80",opacity:1})})]})},[t.address]),n=d.useMemo(()=>a===ye.evm?e.jsx(Ca,{}):e.jsxs(p,{gapX:1,itemAlign:"center",className:"oui-text-2xs",children:[e.jsx("img",{src:"https://oss.orderly.network/static/sdk/solana-logo.png",className:"oui-w-[15px]"}),"Solana"]}),[a]),c=d.useMemo(()=>{let l="";return a==ye.evm?l="oui-bg-[linear-gradient(15deg,#283BEE_-11%,transparent_30%,transparent_77%,#A53411_100%)]":a==ye.solana&&(l="oui-bg-[linear-gradient(15deg,#7400D0_-11%,transparent_30%,transparent_77%,#009A7E_100%)]"),l},[a]);return e.jsxs("div",{className:K(["oui-flex oui-h-[44px] oui-w-full oui-items-center oui-justify-between oui-rounded-[10px] oui-px-3 oui-py-[10px]",c]),children:[r,n]})},_a=()=>{let{state:t}=T(),{wrongNetwork:i}=te(),{description:o,rootClass:s}=va();return d.useMemo(()=>t.status===R.EnableTradingWithoutConnected?!0:i?!1:t.status>=R.EnableTrading,[t.status,i])?e.jsx(Na,{}):e.jsx("div",{className:K(["oui-flex oui-h-[44px] oui-w-full oui-items-center oui-justify-center oui-rounded-[10px] oui-px-3 oui-py-[10px]",s]),children:e.jsx("div",{className:K("oui-flex oui-items-center oui-justify-end oui-rounded-[10px] oui-text-xs oui-font-semibold","oui-text-base-contrast-54"),children:o})})};function Aa(){try{let t=localStorage.getItem("orderly_link_device");return t?Mt(t):null}catch{}}var ka=t=>{var o,s,a;let{t:i}=j();return e.jsxs(p,{className:`
        oui-via-21.6% 
        oui-via-83.23% 
        oui-relative 
        oui-h-[112px] 
        oui-w-full 
        oui-flex-col 
        oui-items-start 
        oui-rounded-xl 
        oui-border 
        oui-border-solid 
        oui-border-[rgba(var(--oui-gradient-primary-start)/0.36)] 
        oui-bg-gradient-to-r
        oui-from-[rgba(var(--oui-gradient-primary-end)/0.12)]
        oui-to-[rgba(var(--oui-gradient-primary-start)/0.12)]
        oui-p-3
      `,children:[e.jsxs(p,{className:"oui-w-full oui-flex-row oui-justify-between oui-items-center",children:[e.jsxs(p,{className:"oui-flex-col oui-items-start",children:[e.jsx(u,{className:"oui-text-base-contrast oui-text-base oui-font-semibold",children:i("affiliate.asAffiliate.affilates")}),e.jsx(u,{className:"oui-text-2xs oui-font-normal oui-text-base-contrast-54",children:i("affiliate.commission")})]}),e.jsx(Yi,{})]}),e.jsxs(p,{className:"oui-mt-auto oui-w-full oui-flex-row oui-items-center oui-gap-1",children:[e.jsx("img",{src:"https://oss.orderly.network/static/symbol_logo/USDC.png",alt:"USDC",className:"oui-size-5"}),e.jsx(u,{className:K("oui-text-xs oui-font-semibold",Qe.isNumber((o=t==null?void 0:t.referralInfo)==null?void 0:o.referrer_info["30d_referrer_rebate"])&&((s=t==null?void 0:t.referralInfo)==null?void 0:s.referrer_info["30d_referrer_rebate"])!=0?"oui-text-base-contrast":"oui-text-base-contrast-36"),children:It((a=t==null?void 0:t.referralInfo)==null?void 0:a.referrer_info["30d_referrer_rebate"],{fix:2,fallback:"--"})}),e.jsx(u,{className:"oui-text-xs oui-font-semibold oui-text-base-contrast-36",children:"(30D)"}),e.jsx(Ie,{size:18,color:"white",className:"oui-ml-auto",onClick:()=>{var r;return(r=t==null?void 0:t.routerAdapter)==null?void 0:r.onRouteChange({href:"/rewards/affiliate?tab=affiliate",name:i("tradingRewards.rewards")})}})]})]})},Ia=t=>{let{t:i}=j(),o=()=>{var s;(s=t.routerAdapter)==null||s.onRouteChange({href:"/portfolio/history",name:i("trading.history")})};return e.jsxs(p,{direction:"row",width:"100%",height:"71px",className:"oui-gap-3 oui-bg-transparent",children:[t.isMainAccount?e.jsxs(e.Fragment,{children:[e.jsxs(p,{direction:"column",gapY:2,itemAlign:"center",className:"oui-flex-1 oui-cursor-pointer",onClick:t==null?void 0:t.onWithdraw,children:[e.jsx("div",{className:"oui-flex oui-size-[48px] oui-items-center oui-justify-center oui-rounded-xl oui-bg-base-9",children:e.jsx(Xe,{size:28,color:"white",opacity:1})}),e.jsx(u,{className:"oui-text-base-80 oui-text-2xs",children:i("common.withdraw")})]}),e.jsxs(p,{direction:"column",gapY:2,itemAlign:"center",className:"oui-flex-1 oui-cursor-pointer",onClick:t==null?void 0:t.onDeposit,children:[e.jsx("div",{className:"oui-flex oui-size-[48px] oui-items-center oui-justify-center oui-rounded-xl oui-bg-base-9",children:e.jsx(Ye,{size:28,color:"white",opacity:1})}),e.jsx(u,{className:"oui-text-base-80 oui-text-2xs",children:i("common.deposit")})]})]}):e.jsxs(p,{direction:"column",gapY:2,itemAlign:"center",className:"oui-flex-1 oui-cursor-pointer",onClick:t==null?void 0:t.onTransfer,children:[e.jsx("div",{className:"oui-flex oui-size-[48px] oui-items-center oui-justify-center oui-rounded-xl oui-bg-base-9",children:e.jsx(Zi,{size:28,color:"white",opacity:1})}),e.jsx(u,{className:"oui-text-base-80 oui-text-2xs",children:i("common.transfer")})]}),e.jsxs(p,{direction:"column",gapY:2,itemAlign:"center",className:"oui-flex-1 oui-cursor-pointer",children:[e.jsx("div",{className:"oui-flex oui-size-[48px] oui-items-center oui-justify-center oui-rounded-xl oui-bg-base-9",onClick:o,children:e.jsx(Xi,{size:28,color:"white",opacity:1,viewBox:"0 0 28 28",className:"oui-w-[28px] oui-h-[28px]"})}),e.jsx(u,{className:"oui-text-base-80 oui-text-2xs",children:i("trading.history")})]})]})},Sa=t=>{let{t:i}=j(),{state:o}=T(),s=d.useMemo(()=>{var a;return t.namespace?t.namespace:o.status===R.EnableTradingWithoutConnected?(a=za())==null?void 0:a.chainNamespace:null},[t.namespace,o.status]);return e.jsxs(p,{direction:"column",width:"100%",height:"100%",className:K(["oui-relative oui-items-start oui-overflow-hidden oui-rounded-2xl oui-bg-base-9",s===ye.evm&&"oui-bg-[#283BEE]",s===ye.solana&&"oui-bg-[#630EAD]"]),p:4,children:[e.jsxs(p,{direction:"row",gapX:1,itemAlign:"center",children:[e.jsx(u,{className:"oui-text-sm oui-text-base-contrast-54",children:"Portfolio value"}),e.jsx(Be,{size:16,className:K(t.canTrade?"oui-text-base-contrast-54":"oui-hidden"),onClick:t.toggleVisible})]}),e.jsxs(p,{direction:"row",gapX:1,itemAlign:"baseline",className:"oui-mt-1",children:[e.jsx(u.numeral,{visible:t.visible,className:"oui-text-3xl oui-font-bold oui-text-base-contrast",children:t.portfolioValue??"--"}),e.jsx(u,{className:"oui-text-base oui-font-bold oui-text-base-contrast-80",children:"USDC"})]}),e.jsxs(p,{direction:"row",gapX:1,itemAlign:"center",className:"oui-text-sm oui-text-base-contrast",children:[e.jsx(u.numeral,{visible:t.visible,children:t.unrealPnL??"--"}),e.jsx(u.numeral,{visible:t.visible,rule:"percentages",prefix:"(",suffix:")",children:t.unrealROI??"--"})]}),e.jsx("div",{className:"oui-absolute oui-right-0 oui-top-0 oui-flex oui-h-full oui-items-center oui-justify-center oui-px-4",onClick:()=>{var a;return(a=t.routerAdapter)==null?void 0:a.onRouteChange({href:"/portfolio/assets",name:"Assets"})},children:e.jsx(Nt,{size:18,color:"white",opacity:.54})})]})};function za(){try{let t=localStorage.getItem("orderly_link_device");return t?Mt(t):null}catch{}}var Ma=t=>{let{t:i}=j();return e.jsxs(p,{direction:"row",width:"100%",className:"oui-cursor-pointer oui-items-center oui-gap-2 oui-rounded-xl oui-bg-base-9 oui-p-4 oui-mb-3",onClick:()=>{var o;return(o=t==null?void 0:t.routerAdapter)==null?void 0:o.onRouteChange({href:"/portfolio/setting",name:i("portfolio.setting")})},children:[e.jsx(io,{size:18,opacity:.98,color:"white"}),e.jsx(u,{className:"oui-text-base oui-font-semibold oui-text-base-contrast-80",children:i("portfolio.setting")}),e.jsx(Ie,{className:"oui-ml-auto",size:18,opacity:.36,color:"white"})]})},Ra=t=>{var o,s,a,r,n,c;let{t:i}=j();return e.jsxs(p,{className:`
        oui-via-21.6% 
        oui-via-83.23% 
        oui-relative 
        oui-h-[112px] 
        oui-w-full 
        oui-flex-col 
        oui-items-start 
        oui-rounded-xl 
        oui-border
        oui-border-solid 
        oui-border-[rgba(var(--oui-gradient-success-start)/0.36)]
        oui-bg-gradient-to-r
        oui-from-[rgba(var(--oui-gradient-success-end)/0.12)]
        oui-to-[rgba(var(--oui-gradient-success-start)/0.12)]
        oui-p-3
      `,children:[e.jsxs(p,{className:"oui-w-full oui-flex-row oui-justify-between oui-items-center",children:[e.jsxs(p,{className:"oui-flex-col oui-items-start",children:[e.jsx(u,{className:"oui-text-base-contrast oui-text-base oui-font-semibold",children:i("affiliate.trader.rebates")}),e.jsx(u,{className:"oui-text-2xs oui-font-normal oui-text-base-contrast-54",children:i("affiliate.trader.tradingRebates")})]}),e.jsx(Qi,{})]}),e.jsxs(p,{className:K("oui-mt-auto oui-w-full oui-flex-row oui-items-center oui-gap-1"),children:[e.jsx("img",{src:"https://oss.orderly.network/static/symbol_logo/USDC.png",alt:"USDC",className:"oui-size-5"}),e.jsx(u,{className:K("oui-text-xs oui-font-semibold",Qe.isNumber((s=(o=t==null?void 0:t.referralInfo)==null?void 0:o.referee_info)==null?void 0:s["30d_referee_rebate"])&&((r=(a=t==null?void 0:t.referralInfo)==null?void 0:a.referee_info)==null?void 0:r["30d_referee_rebate"])!=0?"oui-text-base-contrast":"oui-text-base-contrast-36"),children:It((c=(n=t==null?void 0:t.referralInfo)==null?void 0:n.referee_info)==null?void 0:c["30d_referee_rebate"],{fix:2,fallback:"--"})}),e.jsx(u,{className:"oui-text-xs oui-font-semibold oui-text-base-contrast-36",children:"(30D)"}),e.jsx(Ie,{size:18,color:"white",className:"oui-ml-auto",onClick:()=>{var l;return(l=t==null?void 0:t.routerAdapter)==null?void 0:l.onRouteChange({href:"/rewards/affiliate?tab=trader",name:i("tradingRewards.rewards")})}})]})]})},Ta=t=>{var c,l,m;let{t:i}=j(),o=(c=t.epochList)==null?void 0:c[1].curEpochInfo,s=o==null?void 0:o.end_time,a=o==null?void 0:o.epoch_id,r=o?`${o==null?void 0:o.epoch_token}`.toLowerCase()==="order":void 0,n=h=>{!t.isSignIn||t.wrongNetwork?(h.stopPropagation(),h.preventDefault(),O.alert({title:i("common.tips"),message:e.jsx(u,{intensity:54,children:t.wrongNetwork?i("connector.wrongNetwork.tooltip"):i("affiliate.connectWallet.tooltip")})})):t.goToClaim()};return e.jsxs(p,{className:`
        oui-via-21.6% 
        oui-via-83.23% 
        oui-relative 
        oui-h-[236px] 
        oui-w-full 
        oui-flex-col 
        oui-items-start
        oui-rounded-xl 
        oui-border 
        oui-border-solid 
        oui-border-[rgba(var(--oui-gradient-secondary-start)/0.36)] 
        oui-bg-gradient-to-r
        oui-from-[rgba(var(--oui-gradient-secondary-end)/0.12)]
        oui-to-[rgba(var(--oui-gradient-secondary-start)/0.12)]
        oui-p-3
      `,children:[e.jsxs(p,{className:"oui-w-full oui-flex-row oui-justify-between oui-items-center",children:[e.jsxs(p,{className:"oui-flex-col oui-items-start",children:[e.jsx(u,{className:"oui-text-base-contrast oui-text-base oui-font-semibold oui-whitespace-pre max-[400px]:oui-text-[15px]",children:i("common.tradingRewards")}),e.jsx(u,{className:"oui-text-2xs oui-font-normal oui-whitespace-pre oui-text-base-contrast-54",children:i("tradingRewards.subtitle.mm")})]}),e.jsx(Gi,{})]}),e.jsxs(p,{direction:"row",itemAlign:"center",className:"oui-mb-3 oui-mt-[35px] oui-w-full oui-justify-center oui-gap-1.5",children:[e.jsx(u,{className:"oui-text-sm oui-font-normal oui-text-base-contrast-80",children:i("tradingRewards.epoch")}),e.jsx(u,{className:"oui-text-base-contrast oui-text-sm oui-font-bold",children:a})]}),e.jsx(Ea,{targetTimestamp:s}),e.jsxs(p,{className:"oui-mt-auto oui-w-full oui-flex-row oui-items-center oui-gap-1",children:[r?e.jsx(Ji,{className:"oui-size-5"}):e.jsx(eo,{className:"oui-size-5"}),e.jsx(u,{className:K("oui-text-xs oui-font-semibold",Qe.isNumber((l=t==null?void 0:t.curEpochEstimate)==null?void 0:l.est_r_wallet)?"oui-text-base-contrast":"oui-text-base-contrast-36"),children:((m=t==null?void 0:t.curEpochEstimate)==null?void 0:m.est_r_wallet)??"--"}),e.jsx(p,{className:"oui-ml-auto",children:e.jsx(Ie,{size:18,color:"white",className:"oui-ml-auto",onClick:n})})]})]})},Ea=({targetTimestamp:t})=>{let[i,o]=d.useState({days:0,hours:0,minutes:0,seconds:0});return d.useEffect(()=>{let s=setInterval(()=>{if(typeof t>"u")return;let a=new Date().getTime(),r=t-a;if(r<0)clearInterval(s),o({days:0,hours:0,minutes:0,seconds:0});else{let n=Math.floor(r/864e5),c=Math.floor(r%(1e3*60*60*24)/(1e3*60*60)),l=Math.floor(r%(1e3*60*60)/(1e3*60)),m=Math.floor(r%(1e3*60)/1e3);o({days:n,hours:c,minutes:l,seconds:m})}},1e3);return()=>clearInterval(s)},[t]),e.jsxs(p,{direction:"row",itemAlign:"center",className:"oui-w-full oui-justify-around",children:[e.jsx(Te,{type:"D",value:i.days}),e.jsx(Te,{type:"H",value:i.hours}),e.jsx(Te,{type:"M",value:i.minutes}),e.jsx(Te,{type:"S",value:i.seconds})]})},Te=({type:t,value:i})=>e.jsxs(p,{direction:"column",itemAlign:"center",className:"oui-h-11 oui-w-8 oui-rounded-[6px] oui-bg-white/[0.08]",children:[e.jsx(u,{className:"oui-text-base-contrast oui-text-base oui-font-bold",children:i}),e.jsx(u,{className:"oui-text-2xs oui-font-normal oui-text-base-contrast-36",children:t})]}),Da=t=>{let{canTrade:i,onWithdraw:o,onDeposit:s,portfolioValue:a,unrealPnL:r,unrealROI:n,visible:c,namespace:l,toggleVisible:m,onTransfer:h,isMainAccount:f}=Kt(),{t:g}=j(),x=ha(),b=Po(),{onRouteChange:w}=te(),C=$i(),y=()=>{let E=`https://${C!==to.prod?`${C}-`:""}app.orderly.network/tradingRewards`;window.open(E,"_blank")},S=typeof w=="function"?()=>{w({href:"/portfolio/history",name:g("trading.history")})}:void 0;return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"oui-my-1 oui-px-3",children:e.jsx(_a,{})}),e.jsxs(p,{direction:"column",width:"100%",height:"100%",className:"oui-gap-5 oui-px-3",children:[e.jsxs(p,{direction:"column",width:"100%",gapY:2,children:[e.jsx(Sa,{toggleVisible:m,portfolioValue:a,unrealPnL:r,unrealROI:n,visible:c,canTrade:i,namespace:l,routerAdapter:b==null?void 0:b.routerAdapter}),e.jsx(yo,{className:"oui-mb-2",onClick:S})]}),e.jsx(Ia,{disabled:!i,onWithdraw:o,onDeposit:s,onTransfer:h,isMainAccount:f,routerAdapter:b==null?void 0:b.routerAdapter}),e.jsxs(p,{direction:"row",width:"100%",height:"100%",className:"oui-gap-3",children:[e.jsxs(p,{direction:"column",className:"oui-flex-1 oui-gap-3",children:[e.jsx(ka,{referralInfo:x.referralInfo,routerAdapter:b==null?void 0:b.routerAdapter}),e.jsx(Ra,{referralInfo:x.referralInfo,routerAdapter:b==null?void 0:b.routerAdapter})]}),e.jsx(p,{direction:"column",className:"oui-flex-1",children:e.jsx(Ta,{...x,goToClaim:y})})]}),e.jsx(Ma,{routerAdapter:b==null?void 0:b.routerAdapter})]})]})},Pa=()=>{let{isMobile:t}=ee();return e.jsx(Gt,{children:t?e.jsx(Da,{}):e.jsxs(le,{cols:2,gap:4,children:[e.jsx(Lt,{}),e.jsx(ii,{}),e.jsx(le.span,{colSpan:2,children:e.jsx(si,{})}),e.jsx(le.span,{colSpan:2,children:e.jsx(Le,{})})]})})},Ka={};re(Ka,{FeeTierPage:()=>$a});var pt=[{tier:1,maker_fee:"0.03%",taker_fee:"0.06%",volume_min:0,volume_max:5e5},{tier:2,maker_fee:"0.02%",taker_fee:"0.05%",volume_min:5e5,volume_max:25e5},{tier:3,maker_fee:"0.015%",taker_fee:"0.045%",volume_min:25e5,volume_max:1e7},{tier:4,maker_fee:"0.01%",taker_fee:"0.04%",volume_min:1e7,volume_max:5e7},{tier:5,maker_fee:"0.005%",taker_fee:"0.035%",volume_min:5e7,volume_max:125e6,or:"/",staking_min:3e5,staking_max:null},{tier:6,maker_fee:"0%",taker_fee:"0.03%",volume_min:125e6,volume_max:null,or:"/",staking:null,staking_min:null,staking_max:null}],Fa=()=>{let{t}=j();return d.useMemo(()=>[{title:t("portfolio.feeTier.column.tier"),dataIndex:"tier",align:"left",width:100},{title:`${t("portfolio.feeTier.column.30dVolume")} (USDC)`,dataIndex:"volume",align:"center",width:170,render:(i,o)=>{let{volume_min:s,volume_max:a,volume_node:r}=o;return r||(!s&&!a?e.jsx("div",{style:{fontVariantLigatures:"none"},children:"--"}):s&&!a?e.jsx("div",{children:t("portfolio.feeTier.column.30dVolume.above",{volume:He(s,s===25e5?1:0)})}):e.jsxs("div",{children:[s&&He(s,s===25e5?1:0)," - ",a&&He(a,a===25e5?1:0)]}))}},{title:t("portfolio.feeTier.column.maker"),dataIndex:"maker_fee",align:"right",width:100,render:i=>e.jsx(u,{children:i})},{title:t("portfolio.feeTier.column.taker"),dataIndex:"taker_fee",align:"right",width:100,render:i=>e.jsx(u,{children:i})}],[t])};function La(t){let{dataAdapter:i}=t||{},[o,s]=d.useState(),{data:a}=kt(),{state:r}=T(),n=Fa(),{data:c}=At("/v1/volume/user/stats"),{columns:l,dataSource:m}=d.useMemo(()=>typeof i=="function"?i(n,pt):{columns:n,dataSource:pt},[i,n]),h=(x,b)=>{let{futures_taker_fee_rate:w=0,futures_maker_fee_rate:C=0}=b,y=`${new oe(w).mul(.01).toString()}%`,S=`${new oe(C).mul(.01).toString()}%`;for(let E of x)if(y===E.taker_fee&&S===E.maker_fee)return E.tier};d.useEffect(()=>{if(!a)return;let x=h(m,a);s(x)},[a,m]);let f=d.useMemo(()=>{let x=a==null?void 0:a.futures_taker_fee_rate;if(!(typeof x>"u"))return`${new oe(x).mul(.01).toString()}%`},[a]),g=d.useMemo(()=>{let x=a==null?void 0:a.futures_maker_fee_rate;if(!(typeof x>"u"))return`${new oe(x).mul(.01).toString()}%`},[a]);return{...Ce({tier:o,vol:c==null?void 0:c.perp_volume_last_30_days,takerFeeRate:f,makerFeeRate:g},{accountStatus:r.status===R.EnableTradingWithoutConnected?R.EnableTradingWithoutConnected:R.EnableTrading}),columns:l,dataSource:m,onRow:t==null?void 0:t.onRow}}var Oa=t=>{let{columns:i,dataSource:o,tier:s,vol:a,takerFeeRate:r,makerFeeRate:n}=t,{t:c}=j();return e.jsxs(ae,{title:e.jsxs(p,{justify:"between",children:[e.jsx(u,{size:"lg",children:c("portfolio.feeTier")}),e.jsxs(p,{gap:1,children:[e.jsx(u,{size:"xs",intensity:54,children:c("portfolio.feeTier.updatedDailyBy")}),e.jsx(u,{size:"xs",intensity:80,children:"2:00 UTC"})]})]}),className:"w-full",id:"oui-portfolio-fee-tier",children:[e.jsx(de,{}),e.jsx(Wa,{tier:s,vol:a,takerFeeRate:r,makerFeeRate:n}),e.jsx(Ha,{dataSource:o,columns:i,tier:s,onRow:t.onRow})]})},Wa=t=>{let{t:i}=j();return e.jsxs(p,{direction:"row",gapX:4,my:4,itemAlign:"stretch",children:[e.jsx(Ee,{label:i("portfolio.feeTier.header.yourTier"),value:e.jsx(u.gradient,{color:"brand",angle:270,size:"base",children:t.tier||"--"})}),e.jsx(Ee,{label:`${i("portfolio.feeTier.header.30dVolume")} (USDC)`,value:e.jsx(u.numeral,{rule:"price",dp:2,rm:oe.ROUND_DOWN,children:typeof t.vol!==void 0?`${t.vol}`:"-"})}),e.jsx(Ee,{label:i("portfolio.feeTier.header.takerFeeRate"),value:e.jsx(u.gradient,{color:"brand",angle:270,size:"base",children:t.takerFeeRate||"--"})}),e.jsx(Ee,{label:i("portfolio.feeTier.header.makerFeeRate"),value:e.jsx(u.gradient,{color:"brand",angle:270,size:"base",children:t.makerFeeRate||"--"})})]})},Ee=t=>e.jsxs(W,{gradient:"neutral",r:"lg",px:4,py:2,angle:184,width:"100%",border:!0,borderColor:6,children:[e.jsx(u,{as:"div",intensity:36,size:"2xs",weight:"semibold",className:"oui-leading-[18px]",children:t.label}),e.jsx(u,{size:"base",intensity:80,className:"oui-mt-[2px] oui-leading-[24px]",children:t.value})]}),Ha=t=>{let[i,o]=d.useState(void 0);d.useEffect(()=>{var n,c;let a=(n=document.getElementById("oui-fee-tier-content"))==null?void 0:n.getBoundingClientRect(),r=(c=document.getElementById("oui-fee-tier-current"))==null?void 0:c.getBoundingClientRect();if(r&&a&&t.tier){let l=r.top-a.top;o(l)}else o(void 0)},[t.tier]);let s=d.useCallback((a,r)=>{var c;let n=((c=t==null?void 0:t.onRow)==null?void 0:c.call(t,a,r))??{normal:void 0,active:void 0};return r+1==t.tier?{id:"oui-fee-tier-current","data-state":"active",className:"group oui-h-12 oui-text-[rgba(0,0,0,0.88)] oui-pointer-events-none",...n.active}:{"data-state":"none",className:"oui-h-12",...n.normal}},[t.tier,t.onRow]);return e.jsxs(W,{id:"oui-fee-tier-content",className:"oui-relative oui-border-b oui-border-line-4",children:[i&&e.jsx(W,{angle:90,gradient:"brand",className:"oui-absolute oui-w-full oui-rounded-md",style:{top:`${i}px`,height:"48px"}}),e.jsx(Ue,{bordered:!0,className:"oui-font-semibold",classNames:{root:"oui-bg-transparent"},onRow:s,columns:t.columns,dataSource:t.dataSource})]})},Va=t=>{let i=La(t);return e.jsx(Oa,{...i})},$a=t=>e.jsx(Va,{...t}),Ua={};re(Ua,{PositionsPage:()=>Ba});var Ba=t=>{let[i,o]=d.useState("Positions"),{t:s}=j(),{state:a,isMainAccount:r}=T(),n=a.subAccounts??[],[c,l]=P.useState("All accounts"),m=P.useCallback(x=>{let{name:b,value:w}=x;b==="account"&&l(w)},[]),h={label:s("common.allAccount"),value:"All accounts"},f={label:s("common.mainAccount"),value:"Main accounts"},g=d.useMemo(()=>Array.isArray(n)&&n.length?[h,f,...n.map(x=>({value:x.id,label:(x==null?void 0:x.description)||ue(x==null?void 0:x.id)}))]:[h,f],[n]);return e.jsxs(p,{direction:"column",itemAlign:"start",gap:4,width:"100%",height:"100%",children:[e.jsx(p,{children:e.jsx(u,{size:"lg",children:s("common.positions")})}),e.jsx(de,{className:"oui-w-full"}),e.jsx(W,{width:"100%",className:"oui-h-[calc(100%_-_59px)]",children:e.jsxs(Fe,{value:i,onValueChange:x=>o(x),classNames:{tabsList:"!oui-border-none oui-pb-1",tabsContent:"oui-h-[calc(100%_-_28px)]"},className:"oui-h-full",children:[e.jsxs($,{value:"Positions",title:s("common.positions"),children:[r&&e.jsx(Q,{onFilter:m,items:[{type:"select",name:"account",value:c,options:g}]}),r?e.jsx(ho,{selectedAccount:c,...t}):e.jsx(go,{...t})]}),e.jsx($,{value:"Position history",title:s("positions.positionHistory"),children:e.jsx(fo,{...t})}),e.jsx($,{value:"Liquidation",title:s("positions.liquidation"),children:e.jsx(bo,{})})]})})]})},qa={};re(qa,{OrdersPage:()=>Za});var Za=t=>{let{sharePnLConfig:i}=t,{t:o}=j(),s=d.useRef(null),a=()=>{var r,n;(n=(r=s.current)==null?void 0:r.download)==null||n.call(r)};return e.jsxs(p,{direction:"column",itemAlign:"start",gap:4,width:"100%",height:"100%",children:[e.jsxs(p,{width:"100%",justify:"between",children:[e.jsx(u,{size:"lg",children:o("common.orders")}),e.jsx(Ze,{content:o("orders.download.tooltip"),children:e.jsxs(q,{color:"gray",size:"sm",className:"oui-bg-base-4",onClick:a,children:[o("common.download"),e.jsx(Xa,{className:"oui-text-base-contrast-36 oui-ml-[5px]"})]})})]}),e.jsx(de,{className:"oui-w-full"}),e.jsx(W,{width:"100%",className:"oui-h-[calc(100%_-_59px)]",children:e.jsx(jo,{ref:s,sharePnLConfig:i})})]})},Xa=P.forwardRef((t,i)=>e.jsx("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",ref:i,...t,children:e.jsx("path",{d:"M5.999 1.007a5 5 0 1 0 0 10 5 5 0 0 0 0-10m0 2.5a.5.5 0 1 1 0 1 .5.5 0 0 1 0-1m0 1.5a.5.5 0 0 1 .5.5v2.5a.5.5 0 0 1-1 0v-2.5a.5.5 0 0 1 .5-.5"})})),Ya={};re(Ya,{APIManagerPage:()=>ls,APIManagerWidget:()=>li});var Qa=t=>{let{filterTags:i,keyStatus:o}=t??{},[s,a]=d.useState(!1),[r,n]=d.useState(!1),[c,l]=d.useState(),{wrongNetwork:m,disabledConnect:h}=te(),{state:f,account:g}=T(),{t:x}=j(),b=!m&&!h&&(f.status===R.EnableTrading||f.status===R.EnableTradingWithoutConnected),[w,{generateOrderlyKey:C,setIPRestriction:y,removeOrderlyKey:S,resetOrderlyKeyIPRestriction:E,refresh:I,isLoading:X,error:Z}]=Ui({keyInfo:{key_status:o}}),[v,z]=d.useState(void 0);d.useEffect(()=>{var D;(D=g.keyStore.getOrderlyKey())==null||D.getPublicKey().then(H=>{z(H)})},[g,f]);let _=()=>{a(!0)},M=()=>{window.open("https://orderly.network/docs/build-on-omnichain/evm-api/api-authentication#api-authentication","_blank")},N=()=>{a(!1)},k=async(D,H)=>{var U;try{let V=(Oe,Me)=>{var rt;let{key:ji,secretKey:vi}=Oe;N(),l({key:ji,screctKey:vi,ip:Me,permissions:(rt=H==null?void 0:H.split(","))==null?void 0:rt.map(yi=>ri(yi)).join(", ")}),n(!0)},ne=await C(H);if(F.success(x("portfolio.apiKey.created")),((D==null?void 0:D.length)||0)>0){let Oe=ne.key.startsWith("ed25519:")?ne.key:`ed25519:${ne.key}`,Me=await y(Oe,D);Me.success&&V(ne,(U=Me.data.ip_restriction_list)==null?void 0:U.join(","))}else V(ne,void 0)}catch(V){V!=null&&V.message&&F.error(V==null?void 0:V.message)}return Promise.resolve(0)},A=()=>{n(!1),I()},L=()=>{navigator.clipboard.writeText(JSON.stringify(c)),F.success(x("portfolio.apiKey.apiInfo.copied"))},ie=()=>{A()},se=D=>new Promise(async H=>{await S(D.orderly_key).then(async U=>{var V;if(U!=null&&U.success){F.success(x("portfolio.apiKey.deleted")),I();let ne=await((V=g.keyStore.getOrderlyKey())==null?void 0:V.getPublicKey());D.orderly_key===ne&&g.destroyOrderlyKey()}H(1)},U=>{}).catch(U=>{})}),be=async(D,H)=>{let U;((H==null?void 0:H.length)||0)===0?U=E(D.orderly_key,"ALLOW_ALL_IPS"):U=y(D.orderly_key,H);let V=await U;return V.success?(F.success(x("portfolio.apiKey.updated")),I(),Promise.resolve()):(F.error(V.message),Promise.reject())},je=()=>F.success(x("portfolio.apiKey.accountId.copied")),di=D=>{typeof D<"u"&&navigator.clipboard.writeText(D.replace("ed25519:","")),F.success(x("portfolio.apiKey.column.apiKey.copy"))},mi=()=>F.success(x("portfolio.apiKey.secretKey.copied")),pi=()=>F.success(x("portfolio.apiKey.column.restrictedIP.copy")),xi=d.useMemo(()=>w==null?void 0:w.filter(D=>{let H=i?i==null?void 0:i.includes(D.tag):!0,U=v?!D.orderly_key.includes(v):!0;return H&&U}),[w,i,v]),hi=D=>/^((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])(,((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9]))*$/.test(D)?"":"The IP restriction format is incorrect. Please use the correct format: [xx.xx.xxx.x],[xx.xxx.xxx.xxx]",st=f.status===R.EnableTradingWithoutConnected?R.EnableTradingWithoutConnected:R.EnableTrading,gi=Ce(f.accountId,{accountStatus:st}),fi=Ce(f.userId,{accountStatus:st}),{pagination:bi}=me();return{accountId:gi??"--",userId:fi??"--",onCreateApiKey:_,onReadApiGuide:M,showCreateDialog:s,hideCreateDialog:N,doCreate:k,showCreatedDialog:r,hideCreatedDialog:A,onCopyApiKeyInfo:L,doConfirm:ie,doDelete:se,doEdit:be,canCreateApiKey:b,status:f.status,keys:xi,generateKey:c,onCopyAccountId:je,wrongNetwork:m,onCopyApiKey:di,onCopyApiSecretKey:mi,onCopyIP:pi,verifyIP:hi,isLoading:X,pagination:bi}};function ri(t){return t.charAt(0).toUpperCase()+t.slice(1)}var Ga=t=>{let[i,o]=d.useState(""),[s,a]=d.useState(!0),[r,n]=d.useState(!0),[c,l]=d.useState(!0),[m,h]=d.useState(""),{t:f}=j();return d.useEffect(()=>{t.showCreateDialog||(o(""),a(!0),n(!0),h(""))},[t.showCreateDialog]),d.useEffect(()=>{i.length===0&&h("")},[i]),e.jsx(Ae,{size:"sm",open:t.showCreateDialog,onOpenChange:g=>{var x;(x=t.hideCreateDialog)==null||x.call(t)},title:f("portfolio.apiKey.create.dialog.title"),actions:{primary:{label:f("common.confirm"),className:"oui-w-[120px] lg:oui-w-[154px]","data-testid":"oui-testid-apiKey-createApiKey-dialog-comfirm-btn",onClick:async()=>{if(i.length>0){let x=t.verifyIP(i);if(h(x),x.length>0)return}let g=[];s&&g.push("read"),r&&g.push("trading"),c&&g.push("asset"),await t.doCreate(i,g.join(","))},disabled:!r&&!s&&!c,size:"md"}},classNames:{footer:"oui-justify-center",content:"oui-bg-base-8 oui-w-[300px] lg:oui-w-[360px] oui-font-semibold"},children:e.jsxs(p,{direction:"column",gap:6,children:[e.jsxs(p,{direction:"column",gap:1,width:"100%",itemAlign:"start",children:[e.jsx(u,{intensity:54,size:"2xs",children:f("portfolio.apiKey.create.ipRestriction")}),e.jsx("textarea",{"data-testid":"oui-testid-apiKey-createApiKey-dialog-textarea",placeholder:f("portfolio.apiKey.create.ipRestriction.placeholder"),className:K("oui-h-[100px] oui-w-full oui-rounded-xl oui-bg-base-6 oui-p-3 oui-text-sm oui-text-base-contrast-80","oui-border-0 oui-outline-none focus:oui-border-2 focus:oui-border-primary-darken","oui-placeholder-base-contrast-20",m.length>0&&"oui-outline-1 oui-outline-danger focus:oui-outline-none"),value:i,onChange:g=>{o(g.target.value)},style:{resize:"none"}}),m.length>0&&e.jsxs(p,{gap:1,className:"oui-relative",children:[e.jsx("div",{className:K("oui-absolute oui-top-[10px]","oui-size-1 oui-rounded-full oui-bg-danger")}),e.jsx(u,{color:"danger",size:"xs",className:"oui-ml-2",children:m})]})]}),e.jsx(B,{label:e.jsx(u,{size:"xs",intensity:54,children:f("portfolio.apiKey.permissions")}),className:"oui-w-full",children:e.jsxs(p,{direction:"row",gap:6,itemAlign:"start",className:"oui-mt-2",children:[e.jsx(ce,{size:18,checked:s,onCheckedChange:g=>a(g),label:f("portfolio.apiKey.permissions.read"),testid:"oui-testid-apiKey-createApiKey-dialog-read-checkbox"}),e.jsx(ce,{size:18,checked:r,onCheckedChange:g=>n(g),label:f("portfolio.apiKey.permissions.trading"),testid:"oui-testid-apiKey-createApiKey-dialog-trading-checkbox"}),e.jsx(ce,{size:18,checked:c,onCheckedChange:g=>l(g),label:f("portfolio.apiKey.permissions.asset"),testid:"oui-testid-apiKey-createApiKey-dialog-asset-checkbox"})]})})]})})},ce=t=>e.jsxs("button",{disabled:t.disabled,onClick:i=>{t.onCheckedChange(!t.checked)},className:"oui-flex oui-items-center oui-gap-2 disabled:oui-cursor-not-allowed disabled:oui-opacity-50","data-testid":t.testid,children:[t.checked?e.jsx("svg",{width:"props.size",height:t.size,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M6.99072 2.92981C4.78172 2.92981 2.99072 4.72071 2.99072 6.92981V16.9298C2.99072 19.1389 4.78172 20.9298 6.99072 20.9298H16.9907C19.1997 20.9298 20.9907 19.1389 20.9907 16.9298V6.92981C20.9907 4.72071 19.1997 2.92981 16.9907 2.92981H6.99072ZM16.9853 7.31211C17.2125 7.09537 17.5236 7 17.8218 7C18.1201 7 18.4312 7.09537 18.6584 7.31211C19.1139 7.74546 19.1139 8.47384 18.6584 8.9072L10.5077 16.675C10.0534 17.1083 9.28909 17.1083 8.83472 16.675L5.34077 13.3459C4.88641 12.9126 4.88641 12.1841 5.34077 11.7508C5.79631 11.3175 6.56057 11.3175 7.01493 11.7508L9.67122 14.2822L16.9853 7.31211Z",fill:"white",fillOpacity:"0.54"})}):e.jsx("svg",{width:t.size,height:t.size,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M6.99072 2.92981C4.78172 2.92981 2.99072 4.72071 2.99072 6.92981V16.9298C2.99072 19.1389 4.78172 20.9298 6.99072 20.9298H16.9907C19.1997 20.9298 20.9907 19.1389 20.9907 16.9298V6.92981C20.9907 4.72071 19.1997 2.92981 16.9907 2.92981H6.99072ZM6.99072 4.92981H16.9907C18.0957 4.92981 18.9907 5.82521 18.9907 6.92981V16.9298C18.9907 18.0344 18.0957 18.9298 16.9907 18.9298H6.99072C5.88572 18.9298 4.99072 18.0344 4.99072 16.9298V6.92981C4.99072 5.82521 5.88572 4.92981 6.99072 4.92981Z",fill:"white",fillOpacity:"0.54"})}),e.jsx(u,{intensity:54,size:"sm",className:"oui-whitespace-nowrap oui-break-normal",children:t.label})]}),Ja=t=>{var s,a,r,n;let i=((s=t.generateKey)==null?void 0:s.ip)??"--",{t:o}=j();return e.jsx(Ae,{size:"sm",open:t.showCreatedDialog,onOpenChange:c=>{var l;(l=t.hideCreatedDialog)==null||l.call(t)},title:o("portfolio.apiKey.created"),actions:{primary:{label:o("common.ok"),"data-testid":"oui-testid-apiKey-createdApiKey-dialog-ok-btn",className:"oui-w-[120px] lg:oui-w-[154px] oui-bg-base-2 hover:oui-bg-base-3",size:"md",onClick:async()=>t.doConfirm()},secondary:{label:o("portfolio.apiKey.created.button.copyApiInfo"),"data-testid":"oui-testid-apiKey-createdApiKey-dialog-copy-btn",className:"oui-w-[120px] lg:oui-w-[154px] oui-bg-primary-darken hover:oui-opacity-80",size:"md",onClick:async()=>t.onCopyApiKeyInfo()}},classNames:{footer:"oui-justify-center",content:"oui-bg-base-8 oui-w-[300px] lg:oui-w-[360px] oui-font-semibold",body:"oui-py-0 oui-pt-5"},children:e.jsxs(p,{direction:"column",gap:4,itemAlign:"start",children:[e.jsx(B,{label:o("common.accountId"),children:e.jsx(u.formatted,{size:"sm",intensity:80,copyable:!0,copyIconSize:16,className:"oui-break-all",onCopy:t.onCopyAccountId,"data-testid":"oui-testid-apiKey-createdApiKey-dialog-key-span",children:t.accountId})}),e.jsx(B,{label:o("portfolio.apiKey.column.apiKey"),children:e.jsx(u.formatted,{size:"sm",intensity:80,copyable:!0,copyIconSize:16,className:"oui-break-all",onCopy:()=>{var c;return t.onCopyApiKey((c=t.generateKey)==null?void 0:c.key)},"data-testid":"oui-testid-apiKey-createdApiKey-dialog-key-span",children:(a=t.generateKey)==null?void 0:a.key})}),e.jsxs(B,{label:o("portfolio.apiKey.secretKey"),children:[e.jsx(u.formatted,{size:"sm",intensity:80,copyable:!0,copyIconSize:16,className:"oui-break-all",onCopy:t.onCopyApiSecretKey,children:(r=t.generateKey)==null?void 0:r.screctKey})," "]}),e.jsx(B,{label:o("portfolio.apiKey.ip"),children:e.jsxs(p,{width:320,gap:1,itemAlign:"center",className:"oui-text-base-contrast-80 oui-text-sm",children:[e.jsx(W,{className:"oui-max-h-[100px] oui-flex-1 oui-overflow-hidden oui-text-ellipsis oui-line-clamp-5 oui-break-all",children:i}),i!=="--"&&e.jsx(W,{width:16,height:16,className:"oui-cursor-pointer oui-flex-shrink-0",children:e.jsx(Ge,{color:"white",opacity:.54,size:16,onClick:c=>{var l,m;(l=t.generateKey)!=null&&l.ip&&navigator.clipboard.writeText((m=t.generateKey)==null?void 0:m.ip),t==null||t.onCopyIP()}})})]})}),e.jsx(B,{label:o("portfolio.apiKey.permissions"),children:e.jsx(u,{size:"sm",intensity:80,"data-testid":"oui-testid-apiKey-createdApiKey-dialog-permissions-span",children:(n=t.generateKey)==null?void 0:n.permissions})}),e.jsx("div",{}),e.jsx(u,{color:"warning",size:"xs",className:"oui-text-center",children:o("portfolio.apiKey.created.warning")})]})})},es=t=>{let{item:i,open:o,setOpen:s,onDelete:a}=t,{t:r}=j();return e.jsx(Ae,{size:"sm",open:o,onOpenChange:s,title:r("portfolio.apiKey.delete.dialog.title"),actions:{primary:{label:r("common.confirm"),"data-testid":"oui-testid-apiKey-deleteApiKey-dialog-confirm-btn",className:"oui-w-[120px] lg:oui-w-[154px]",size:"md",onClick:async()=>{var n;await((n=t.onDelete)==null?void 0:n.call(t,i)),s(!1)}},secondary:{label:r("common.cancel"),className:"oui-w-[120px] lg:oui-w-[154px]",size:"md",onClick:async()=>{s(!1)}}},classNames:{footer:"oui-justify-center",content:"oui-bg-base-8 oui-w-[300px] lg:oui-w-[360px] oui-font-semibold"},children:e.jsx(p,{className:"oui-text-xs",children:e.jsx(_o,{i18nKey:"portfolio.apiKey.delete.dialog.description",values:{apiKey:ni(i==null?void 0:i.orderly_key)},components:[e.jsx(u,{color:"primary",className:"oui-px-1"})]})})})},ts=t=>{var C;let{item:i,open:o,setOpen:s,onUpdate:a}=t,[r,n]=d.useState((C=i.ip_restriction_list)==null?void 0:C.join(",")),[c,l]=d.useState(!0),[m,h]=d.useState(!0),[f,g]=d.useState(!0),[x,b]=d.useState(""),{t:w}=j();return d.useEffect(()=>{var S;n(i.ip_restriction_list.join(","));let y=((S=i.scope)==null?void 0:S.toLocaleLowerCase())||"";l(y.includes("read")),h(y.includes("trading")),g(y.includes("asset"))},[i]),d.useEffect(()=>{r.length===0&&b("")},[r]),e.jsx(Ae,{size:"sm",open:o,onOpenChange:s,title:w("portfolio.apiKey.edit.dialog.title"),actions:{primary:{label:w("common.confirm"),"data-testid":"oui-testid-apiKey-editApiKey-dialog-confirm-btn",className:"oui-w-[120px] lg:oui-w-[154px]",onClick:async()=>{var y;if(r.length>0){let S=t.verifyIP(r);if(b(S),S.length>0)return}await((y=t.onUpdate)==null?void 0:y.call(t,i,r)),s(!1)},disabled:i.ip_restriction_list.join(",")===r,size:"md",fullWidth:!0}},classNames:{footer:"oui-justify-center",content:"oui-bg-base-8 oui-w-[300px] lg:oui-w-[360px] oui-font-semibold"},children:e.jsxs(p,{direction:"column",gap:6,children:[e.jsxs(p,{direction:"column",gap:1,width:"100%",itemAlign:"start",children:[e.jsx(u,{intensity:54,size:"2xs",children:w("portfolio.apiKey.create.ipRestriction")}),e.jsx("textarea",{"data-testid":"oui-testid-apiKey-editApiKey-dialog-textarea",placeholder:w("portfolio.apiKey.create.ipRestriction.placeholder"),className:K("oui-h-[100px] oui-w-full oui-rounded-xl oui-bg-base-6 oui-p-3 oui-text-sm oui-text-base-contrast-80","oui-border-0 oui-outline-none focus:oui-border-2 focus:oui-border-primary-darken","oui-placeholder-base-contrast-20",x.length>0&&"oui-outline-1 oui-outline-danger focus:oui-outline-none"),value:r,onChange:y=>{n(y.target.value)},style:{resize:"none"}}),x.length>0&&e.jsxs(p,{gap:1,className:"oui-relative",children:[e.jsx("div",{className:K("oui-absolute oui-top-[10px]","oui-size-1 oui-rounded-full oui-bg-danger")}),e.jsx(u,{color:"danger",size:"xs",className:"oui-ml-2",children:x})]})]}),e.jsx(B,{label:e.jsx(u,{size:"xs",intensity:54,children:w("portfolio.apiKey.permissions")}),className:"oui-w-full",children:e.jsxs(p,{direction:"row",gap:6,itemAlign:"start",className:"oui-mt-2",children:[e.jsx(ce,{disabled:!0,size:18,checked:c,onCheckedChange:y=>l(y),label:w("portfolio.apiKey.permissions.read")}),e.jsx(ce,{disabled:!0,size:18,checked:m,onCheckedChange:y=>h(y),label:w("portfolio.apiKey.permissions.trading")}),e.jsx(ce,{disabled:!0,size:18,checked:f,onCheckedChange:y=>g(y),label:w("portfolio.apiKey.permissions.asset")})]})})]})})},is=t=>{let{t:i}=j();return e.jsxs(ae,{title:i("portfolio.apiKeys"),id:"portfolio-apikey-manager",className:"oui-bg-base-9 oui-font-semibold",children:[e.jsxs(p,{direction:"column",gap:4,width:"100%",className:"oui-font-semibold",children:[e.jsx(os,{...t}),e.jsx(as,{...t})]}),e.jsxs("div",{children:[e.jsx(ss,{...t}),e.jsx(Ga,{...t}),e.jsx(Ja,{...t})]})]})},os=t=>{let{t:i}=j();return e.jsxs(p,{width:"100%",gap:4,className:"oui-border-t-2 oui-border-line-6 oui-pt-4",children:[e.jsxs(p,{py:2,px:4,direction:"column",itemAlign:"start",r:"xl",gradient:"neutral",angle:27,border:!0,className:"oui-w-1/2",children:[e.jsx(u,{size:"xs",intensity:36,children:i("common.accountId")}),e.jsx(u.formatted,{size:"base",inlist:80,rule:"address",copyable:t.accountId!=="--",copyIconSize:16,onCopy:t.onCopyAccountId,copyIconTestid:"oui-testid-apiKey-accountInfo-accountId-copy-btn",children:t.accountId})]}),e.jsxs(p,{py:2,px:4,direction:"column",itemAlign:"start",r:"xl",gradient:"neutral",angle:27,border:!0,className:"oui-w-1/2",children:[e.jsx(u,{size:"xs",intensity:36,children:i("portfolio.apiKey.uid")}),e.jsx(u,{size:"base",inlist:80,children:t.userId})]})]})},as=t=>{let{t:i}=j();return e.jsxs(p,{width:"100%",direction:"row",className:"oui-text-sm oui-border-b-2 oui-border-line-6 oui-pb-4",children:[e.jsxs(p,{direction:"column",itemAlign:"start",width:"100%",gap:1,children:[e.jsx(u,{intensity:54,children:i("portfolio.apiKey.description")}),e.jsxs(p,{itemAlign:"center",className:"oui-text-primary-light oui-fill-primary-light hover:oui-text-primary-darken oui-cursor-pointer oui-text-2xs md:oui-text-xs xl:oui-text-sm",onClick:t.onReadApiGuide,children:[e.jsx(u,{children:i("portfolio.apiKey.readApiGuide")}),e.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M4.008 7.995c0-.368.298-.666.666-.666H9.71L7.733 5.331l.937-.936 3.143 3.122c.13.13.195.304.195.479a.67.67 0 0 1-.195.478L8.67 11.596l-.937-.937 1.978-1.998H4.674a.666.666 0 0 1-.666-.666"})})]})]}),e.jsx(et,{side:"top",tooltip:{connectWallet:i("portfolio.apiKey.create.connectWallet.tooltip"),signIn:i("portfolio.apiKey.create.createAccount.tooltip"),enableTrading:i("portfolio.apiKey.create.enableTrading.tooltip"),wrongNetwork:i("portfolio.apiKey.create.wrongNetwork.tooltip")},children:e.jsx(q,{size:"md",icon:e.jsx(oo,{}),variant:"contained",color:"primary",onClick:t.onCreateApiKey,disabled:!t.canCreateApiKey,"data-testid":"oui-testid-apiKey-createApiKey-btn",children:i("portfolio.apiKey.create.dialog.title")})})]})},ss=t=>{let{t:i}=j(),o=[{title:i("portfolio.apiKey.column.apiKey"),dataIndex:"orderly_key",render:s=>e.jsx(u.formatted,{rule:"",copyable:!0,copyIconSize:16,onCopy:()=>{var a;(a=t.onCopyApiKey)==null||a.call(t,s)},children:ni(s)})},{title:i("portfolio.apiKey.column.permissionType"),dataIndex:"scope",render:s=>s==null?void 0:s.split(",").map(a=>ri(`${a}`)).join(", ")},{title:i("portfolio.apiKey.column.restrictedIP"),dataIndex:"ip_restriction_list",render:s=>{let a=s.join(",");return a.length===0&&(a="--"),e.jsx(Ze,{content:a,className:"oui-max-w-[200px] oui-break-all",children:e.jsxs(p,{gap:1,children:[e.jsx("div",{className:" oui-overflow-ellipsis oui-overflow-hidden",children:a}),a!=="--"&&e.jsx(W,{width:16,height:16,className:"oui-cursor-pointer",children:e.jsx(Ge,{color:"white",opacity:.54,size:16,onClick:r=>{navigator.clipboard.writeText(a),t==null||t.onCopyIP()}})})]})})}},{title:i("portfolio.apiKey.column.expirationDate"),dataIndex:"expiration",render:s=>e.jsx(u.formatted,{rule:"date",formatString:"yyyy-MM-dd",children:s})},{title:"",type:"action",dataIndex:"action",width:120,render:(s,a)=>e.jsxs(p,{direction:"row",gap:2,children:[e.jsx(rs,{item:a,onUpdate:t.doEdit,verifyIP:t.verifyIP}),e.jsx(ns,{item:a,onDelete:t.doDelete})]})}];return e.jsx(xe,{bordered:!0,columns:o,loading:t.isLoading,dataSource:t.keys,emptyView:e.jsx(No,{}),classNames:{},pagination:t.pagination,manualPagination:!1})},rs=t=>{let{item:i,onUpdate:o,verifyIP:s}=t,[a,r]=d.useState(!1),{t:n}=j();return e.jsxs(e.Fragment,{children:[e.jsx(q,{size:"xs",color:"primary",variant:"contained",onClick:c=>{c.stopPropagation(),r(!0)},"data-testid":"oui-testid-apiKey-keyList-edit-btn",children:n("common.edit")}),a&&e.jsx(ts,{item:i,open:a,setOpen:r,onUpdate:o,verifyIP:s})]})},ns=t=>{let{item:i,onDelete:o}=t,[s,a]=d.useState(!1),{t:r}=j();return e.jsxs(e.Fragment,{children:[e.jsx(q,{size:"xs",color:"gray",variant:"contained",onClick:n=>{n.stopPropagation(),a(!0)},"data-testid":"oui-testid-apiKey-keyList-delete-btn",children:r("common.delete")}),s&&e.jsx(es,{item:i,open:s,setOpen:a,onDelete:o})]})};function ni(t){return typeof t>"u"?"-":`${`${t}`.replace("ed25519:","").slice(0,6)}*****`}var li=t=>{let i=Qa(t);return e.jsx(is,{...i})},ls=t=>{let{filterTags:i,keyStatus:o="ACTIVE"}=t;return e.jsx(li,{filterTags:i,keyStatus:o})},cs={};re(cs,{SettingPage:()=>xs,SettingWidget:()=>ci});var us=t=>{let{t:i}=j();return e.jsx(ae,{title:i("portfolio.setting.systemUpgrade"),id:"portfolio-apikey-manager",className:"oui-bg-base-9 oui-font-semibold",children:e.jsxs(p,{direction:"row",gap:4,width:"100%",itemAlign:"center",pt:4,className:"oui-border-t-2 oui-border-line-6 oui-font-semibold",children:[e.jsxs(p,{direction:"column",itemAlign:"start",className:"oui-flex-1",children:[e.jsx(u,{intensity:80,size:"base",children:i("portfolio.setting.cancelOpenOrders")}),e.jsx(u,{intensity:54,size:"sm",children:i("portfolio.setting.cancelOpenOrders.description")})]}),e.jsx(et,{align:"end",children:e.jsx(St,{checked:t.maintenance_cancel_orders,onCheckedChange:o=>{t.setMaintainConfig(o)},disabled:t.isSetting||!t.canTouch,"data-testid":"oui-testid-setting-switch-btn"})})]})})},ds=t=>{let{t:i}=j(),[o,s]=d.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs(p,{mt:1,mb:2,p:4,intensity:900,r:"xl",itemAlign:"center",children:[e.jsx(xo,{open:o,onOpenChange:s}),e.jsxs(p,{className:"oui-cursor-pointer",itemAlign:"center",width:"100%",onClick:()=>{s(!0)},children:[e.jsx(u,{size:"base",weight:"semibold",intensity:80,className:"oui-ml-2",children:i("languageSwitcher.language")}),e.jsx(Ie,{size:18,className:"oui-ml-auto oui-text-base-contrast-36"})]})]}),e.jsx(ae,{title:e.jsx("div",{className:"oui-text-sm",children:i("portfolio.setting.systemUpgrade")}),id:"portfolio-apikey-manager",className:"oui-bg-base-9 oui-font-semibold",classNames:{root:"oui-p-4",content:"!oui-pt-3"},children:e.jsx(p,{direction:"row",gap:4,width:"100%",itemAlign:"center",pt:3,className:"oui-font-semibold oui-border-t-2 oui-border-line-6",children:e.jsxs(p,{direction:"column",itemAlign:"start",className:"oui-flex-1 oui-gap-2",children:[e.jsx(u,{intensity:80,size:"xs",children:i("portfolio.setting.cancelOpenOrders")}),e.jsx(u,{intensity:36,size:"2xs",className:"oui-font-normal",children:i("portfolio.setting.cancelOpenOrders.description")}),e.jsx(et,{children:e.jsx(St,{className:"oui-mt-1",checked:t.maintenance_cancel_orders,onCheckedChange:a=>{t.setMaintainConfig(a)},disabled:t.isSetting||!t.canTouch,"data-testid":"oui-testid-setting-switch-btn"})})]})})})]})},ms=t=>{let{isMobile:i}=ee();return i?e.jsx("div",{className:"oui-px-3",children:e.jsx(ds,{...t})}):e.jsx(us,{...t})},ps=()=>{let{data:t,mutate:i}=kt(),{wrongNetwork:o,disabledConnect:s}=te(),[a,{isMutating:r}]=Bi("/v1/client/maintenance_config"),[n,c]=d.useState(!1);d.useEffect(()=>{c((t==null?void 0:t.maintenance_cancel_orders)||!1)},[t]);let l=qi(g=>{a({maintenance_cancel_order_flag:g}).then(x=>{x.success?F.success(g?"Opened":"Closed"):c(!g)})},300),m=g=>{c(g),l(g)},{state:h}=T(),f=!o&&!s&&(h.status===R.EnableTrading||h.status===R.EnableTradingWithoutConnected);return{maintenance_cancel_orders:n,setMaintainConfig:m,isSetting:!1,canTouch:f}},ci=()=>{let t=ps();return e.jsx(ms,{...t})},xs=()=>e.jsx(ci,{}),hs={};re(hs,{AssetsPage:()=>Ns});var xt=t=>typeof t=="number"&&!Number.isNaN(t),ui=(t,i)=>t==="USDC"?1:(i==null?void 0:i[`PERP_${t}_USDC`])??0,$e=(t,i,o)=>{let s=ui(i,o);return new oe(t).mul(s)},Ve=(t,i)=>{let o=new oe(0);for(let s of t)if(Array.isArray(s.holding)){for(let a of s.holding)if(xt(a.holding)){let r=$e(a.holding,a.token,i);o=o.plus(r)}}else if(xt(s.holding)&&"token"in s){let a=$e(s.holding,s.token,i);o=o.plus(a)}return o},gs=()=>{let{state:t,isMainAccount:i}=T(),{holding:o=[]}=pe(),{data:s}=Je(),a=ot(),r=t.subAccounts??[],n=d.useMemo(()=>Ve(o,s),[o,s]),c=d.useMemo(()=>Ve(r,s),[r,s]);return d.useMemo(()=>{if(i)return n.plus(c).toNumber();{let l=a.find(m=>m.id===t.accountId);return Array.isArray(l==null?void 0:l.children)?Ve(l.children,s).toNumber():0}},[i,n,c,a,t.accountId,s])},fs=t=>{let{t:i}=j(),o=Pe(),{onTransfer:s,onConvert:a}=t;return P.useMemo(()=>[{title:i("portfolio.overview.column.token"),dataIndex:"token",align:"left",width:150,render(r){return e.jsxs(p,{itemAlign:"center",gap:2,children:[e.jsx(J,{name:r}),r]})}},{title:i("portfolio.overview.column.qty"),dataIndex:"holding",align:"left",width:140,render(r,n){let c=o==null?void 0:o.find(({token:l})=>l===n.token);return e.jsx(u.numeral,{dp:(c==null?void 0:c.decimals)??6,padding:!1,children:r})}},{title:i("portfolio.overview.column.indexPrice"),dataIndex:"indexPrice",align:"left",width:140,render(r){return e.jsx(u.numeral,{rule:"price",dp:6,currency:"$",padding:!1,children:r})}},{title:i("portfolio.overview.column.assetValue"),dataIndex:"assetValue",align:"left",width:140,render(r){return e.jsx(u.numeral,{rule:"price",dp:6,currency:"$",padding:!1,children:r})}},{title:i("portfolio.overview.column.collateralRatio"),dataIndex:"collateralRatio",align:"left",width:140,render(r){return e.jsx(u.numeral,{dp:2,suffix:"%",children:r*100})}},{title:i("transfer.deposit.collateralContribution"),dataIndex:"collateralContribution",align:"left",width:140,render(r){return e.jsx(u.numeral,{rule:"price",dp:6,currency:"$",padding:!1,children:r})}},{title:null,dataIndex:"account_id",align:"right",width:180,render(r,n){return e.jsxs(p,{itemAlign:"center",gap:3,children:[e.jsx(q,{size:"sm",variant:"outlined",color:"secondary",onClick:()=>a==null?void 0:a(r,n.token),className:K(n.token==="USDC"?"oui-invisible":"oui-visible"),children:i("transfer.convert")}),s&&e.jsx(q,{size:"sm",variant:"outlined",color:"secondary",onClick:()=>s==null?void 0:s(r,n.token),children:i("common.transfer")})]})}}],[i,o,s,a])},bs="orderly_assets_visible",js=()=>{let[t,i]=Ke(bs,!0),{state:o,subAccount:s,isMainAccount:a}=T(),{holding:r=[]}=pe(),{data:n}=Je(),c=Pe(),l=o.subAccounts??[];d.useEffect(()=>{r.length>0&&s.refresh()},[r]);let m=gs(),h=()=>{i(_=>!_)},f=d.useMemo(()=>(c==null?void 0:c.map(_=>({label:_.token,value:_.token})))||[],[c]),g=ot(),{selectedAccount:x,selectedAsset:b,filteredData:w,onFilter:C}=aa(g),y=d.useMemo(()=>w.map(_=>{var N;let M=((N=_.children)==null?void 0:N.map(k=>{let A=c==null?void 0:c.find(je=>je.token===k.token),L=ui(k.token,n),ie=$e(k.holding,k.token,n).toNumber(),se=A?ct.collateralRatio({baseWeight:A.base_weight??0,discountFactor:A.discount_factor??0,collateralQty:k.holding,collateralCap:(A==null?void 0:A.user_max_qty)??k.holding,indexPrice:L}):ve,be=ct.collateralContribution({collateralQty:k.holding,collateralCap:(A==null?void 0:A.user_max_qty)??k.holding,collateralRatio:se.toNumber(),indexPrice:L});return{...k,indexPrice:L,assetValue:ie,collateralRatio:se,collateralContribution:be}}))||[];return{..._,children:M}}),[w,n,c]),S=d.useCallback((_,M)=>{_&&O.show(Dt,{toAccountId:_,token:M})},[]),E=(_,M)=>{O.show("ConvertDialogId",{accountId:_,token:M})},I=a?l.length>0:!0,X=fs({onTransfer:I?S:void 0,onConvert:E}),Z=d.useCallback(_=>{O.show(Et,{activeTab:_})},[]),v=d.useCallback(()=>{Z("deposit")},[]),z=d.useCallback(()=>{Z("withdraw")},[]);return{columns:X,dataSource:y,visible:t,onToggleVisibility:h,selectedAccount:x,selectedAsset:b,onFilter:C,totalValue:m,hasSubAccount:l.length>0,onDeposit:v,onWithdraw:z,holding:r,assetsOptions:f}},vs=t=>{let{t:i}=j(),o=t.state.subAccounts??[],s={label:i("common.allAccount"),value:"All accounts"},a={label:i("common.mainAccount"),value:"Main accounts"},r={label:"All assets",value:"all"},n=d.useMemo(()=>Array.isArray(o)&&o.length?[s,a,...o.map(l=>({value:l.id,label:(l==null?void 0:l.description)||ue(l==null?void 0:l.id)}))]:[s,a],[o]),c=d.useMemo(()=>[r,...t.assetsOptions],[t.assetsOptions]);return e.jsxs("div",{className:"oui-flex oui-flex-col oui-gap-1 oui-px-3 oui-pb-4",children:[e.jsx("div",{children:t.isMainAccount&&e.jsx(Q,{onFilter:t.onFilter,className:"oui-border-none oui-py-2",items:[{size:"sm",type:"picker",name:"account",value:t.selectedAccount,options:n},{size:"sm",type:"picker",name:"asset",value:t.selectedAsset,options:c}]})}),e.jsx("div",{className:"oui-flex oui-flex-col oui-gap-1",children:t.dataSource.map(l=>e.jsxs(e.Fragment,{children:[e.jsx(ws,{name:l.description??"sub account"}),l.children.map(m=>e.jsx(ys,{item:m},`${m.token}-${m.account_id}`))]}))})]})},ys=({item:t})=>{let{t:i}=j();return e.jsxs("div",{className:"oui-flex oui-flex-col oui-gap-3 oui-rounded-xl oui-bg-base-9 oui-p-4",children:[e.jsxs("div",{className:"oui-flex oui-items-center oui-justify-between",children:[e.jsxs("div",{className:"oui-flex oui-flex-col",children:[e.jsx("div",{className:"oui-text-2xs oui-font-semibold oui-text-base-contrast-36",children:i("common.token")}),e.jsxs("div",{className:"oui-flex oui-items-center oui-gap-1 oui-text-xs oui-font-semibold oui-text-base-contrast-80",children:[e.jsx(J,{name:t.token,className:"oui-size-4"})," ",t.token]})]}),e.jsxs("div",{className:"oui-flex oui-flex-col",children:[e.jsx("div",{className:"oui-text-2xs oui-font-semibold oui-text-base-contrast-36",children:i("common.quantity")}),e.jsx("div",{children:e.jsx(u.numeral,{dp:6,padding:!1,children:t.holding})})]}),e.jsxs("div",{className:"oui-flex oui-flex-col",children:[e.jsx("div",{className:"oui-text-2xs oui-font-semibold oui-text-base-contrast-36",children:i("transfer.deposit.collateralContribution")}),e.jsxs("div",{className:"oui-flex oui-items-center oui-gap-1 oui-self-end oui-text-xs oui-font-semibold oui-text-base-contrast-80",children:[e.jsx(u.numeral,{dp:6,padding:!1,children:t.collateralContribution}),e.jsx("div",{className:"oui-text-base-contrast-36",children:"USDC"})]})]})]}),e.jsxs("div",{className:"oui-flex oui-gap-2",children:[e.jsx(q,{variant:"outlined",size:"sm",color:"gray",onClick:()=>O.show("ConverSheetId",{accountId:t.account_id,token:t.token}),disabled:t.token==="USDC",className:K("oui-flex-1 oui-border-white/[0.36] oui-text-base-contrast-54",t.token==="USDC"&&"hover:!oui-bg-transparent disabled:oui-border-white/[0.16] disabled:!oui-bg-transparent disabled:oui-text-base-contrast-20"),children:i("transfer.convert")}),e.jsx(q,{variant:"outlined",size:"sm",color:"gray",onClick:()=>O.show("TransferSheetId",{accountId:t.account_id,token:t.token}),className:K("oui-flex-1 oui-border-white/[0.36] oui-text-base-contrast-54"),children:i("common.transfer")})]})]})},ws=({name:t})=>e.jsx("div",{className:"oui-mt-2 oui-flex oui-h-[18px] oui-w-fit oui-items-center oui-rounded oui-bg-white/[0.06] oui-px-2 oui-text-2xs oui-font-semibold oui-text-base-contrast-36",children:t}),Cs=()=>{let t=js(),i=T(),{isMobile:o}=ee();return o?e.jsx(vs,{...t,...i}):e.jsx(ia,{...t,...i})},Ns=()=>e.jsx(Cs,{}),_s={};re(_s,{HistoryPage:()=>ks,HistoryWidget:()=>As});var As=()=>e.jsx(Le,{}),ks=()=>e.jsx(Le,{});export{Ka as A,Ya as B,qa as P,Ua as S,_s as a,Ks as b,cs as e,Lo as f,hs as v};
