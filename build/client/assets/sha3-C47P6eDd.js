import{r as q,a as v}from"./_u64-CPCIv9dJ.js";var o={},A;function R(){if(A)return o;A=1,Object.defineProperty(o,"__esModule",{value:!0}),o.shake256=o.shake128=o.keccak_512=o.keccak_384=o.keccak_256=o.keccak_224=o.sha3_512=o.sha3_384=o.sha3_256=o.sha3_224=o.Keccak=void 0,o.keccakP=B;const l=q(),a=v(),H=BigInt(0),k=BigInt(1),S=BigInt(2),T=BigInt(7),F=BigInt(256),X=BigInt(113),I=[],O=[],w=[];for(let n=0,t=k,s=1,i=0;n<24;n++){[s,i]=[i,(2*s+3*i)%5],I.push(2*(5*i+s)),O.push((n+1)*(n+2)/2%64);let r=H;for(let h=0;h<7;h++)t=(t<<k^(t>>T)*X)%F,t&S&&(r^=k<<(k<<BigInt(h))-k);w.push(r)}const y=(0,l.split)(w,!0),m=y[0],E=y[1],b=(n,t,s)=>s>32?(0,l.rotlBH)(n,t,s):(0,l.rotlSH)(n,t,s),g=(n,t,s)=>s>32?(0,l.rotlBL)(n,t,s):(0,l.rotlSL)(n,t,s);function B(n,t=24){const s=new Uint32Array(10);for(let i=24-t;i<24;i++){for(let e=0;e<10;e++)s[e]=n[e]^n[e+10]^n[e+20]^n[e+30]^n[e+40];for(let e=0;e<10;e+=2){const c=(e+8)%10,d=(e+2)%10,p=s[d],f=s[d+1],P=b(p,f,1)^s[c],U=g(p,f,1)^s[c+1];for(let x=0;x<50;x+=10)n[e+x]^=P,n[e+x+1]^=U}let r=n[2],h=n[3];for(let e=0;e<24;e++){const c=O[e],d=b(r,h,c),p=g(r,h,c),f=I[e];r=n[f],h=n[f+1],n[f]=d,n[f+1]=p}for(let e=0;e<50;e+=10){for(let c=0;c<10;c++)s[c]=n[e+c];for(let c=0;c<10;c++)n[e+c]^=~s[(c+2)%10]&s[(c+4)%10]}n[0]^=m[i],n[1]^=E[i]}(0,a.clean)(s)}class _ extends a.Hash{constructor(t,s,i,r=!1,h=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=t,this.suffix=s,this.outputLen=i,this.enableXOF=r,this.rounds=h,(0,a.anumber)(i),!(0<t&&t<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=(0,a.u32)(this.state)}clone(){return this._cloneInto()}keccak(){(0,a.swap32IfBE)(this.state32),B(this.state32,this.rounds),(0,a.swap32IfBE)(this.state32),this.posOut=0,this.pos=0}update(t){(0,a.aexists)(this),t=(0,a.toBytes)(t),(0,a.abytes)(t);const{blockLen:s,state:i}=this,r=t.length;for(let h=0;h<r;){const e=Math.min(s-this.pos,r-h);for(let c=0;c<e;c++)i[this.pos++]^=t[h++];this.pos===s&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:t,suffix:s,pos:i,blockLen:r}=this;t[i]^=s,(s&128)!==0&&i===r-1&&this.keccak(),t[r-1]^=128,this.keccak()}writeInto(t){(0,a.aexists)(this,!1),(0,a.abytes)(t),this.finish();const s=this.state,{blockLen:i}=this;for(let r=0,h=t.length;r<h;){this.posOut>=i&&this.keccak();const e=Math.min(i-this.posOut,h-r);t.set(s.subarray(this.posOut,this.posOut+e),r),this.posOut+=e,r+=e}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return(0,a.anumber)(t),this.xofInto(new Uint8Array(t))}digestInto(t){if((0,a.aoutput)(t,this),this.finished)throw new Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,(0,a.clean)(this.state)}_cloneInto(t){const{blockLen:s,suffix:i,outputLen:r,rounds:h,enableXOF:e}=this;return t||(t=new _(s,i,r,e,h)),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=h,t.suffix=i,t.outputLen=r,t.enableXOF=e,t.destroyed=this.destroyed,t}}o.Keccak=_;const u=(n,t,s)=>(0,a.createHasher)(()=>new _(t,n,s));o.sha3_224=u(6,144,224/8),o.sha3_256=u(6,136,256/8),o.sha3_384=u(6,104,384/8),o.sha3_512=u(6,72,512/8),o.keccak_224=u(1,144,224/8),o.keccak_256=u(1,136,256/8),o.keccak_384=u(1,104,384/8),o.keccak_512=u(1,72,512/8);const L=(n,t,s)=>(0,a.createXOFer)((i={})=>new _(t,n,i.dkLen===void 0?s:i.dkLen,!0));return o.shake128=L(31,168,128/8),o.shake256=L(31,136,256/8),o}export{R as r};
